/* translate autoc in ~/sc/src/all.lsp to C
 *   written Wed 20-Oct-21 at 9:50 by CLM of 8-May-18
 */

#include <mus-config.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <stdarg.h>
#include <math.h>
#include <signal.h>
#include <cmus.h>

static sig_atomic_t got_sigint = 0; /* catch C-C if hung */
static void sig_err(int sig) {got_sigint = sig;}

int clm_autoc (double *clm_double, int datar_len, int *clm_int, int datai_len)
{
  /* The _clm_* variables are temporary values generated by the run macro */
  void (*old_SIGINT)(int);
  mus_long_t _clm_1162, _clm_1117, _clm_1063, _clm_1050, _clm_979, _clm_970, _clm_953, _clm_945, LOOP_LIMIT_929, _clm_933, _clm_927, _clm_884, _clm_876, LOOP_LIMIT_861, N, M, _clm_763, _clm_535, PEAKX, _clm_518, MAXPEAKINDEX, _clm_495, _clm_489, LOOP_LIMIT_465, X, ENDX, _clm_463, _clm_461, STARTX, _clm_459, TWEENX, _clm_385, _clm_384, _clm_332, _clm_326, _clm_306, _clm_286, FFT2, _clm_280, K, _clm_61, _clm_59, NC, _clm_22, I;
  bool _clm_1174, _clm_1159, _clm_1153, _clm_1139, _clm_1128, _clm_1112, _clm_1094, _clm_1093, _clm_1090, _clm_1079, _clm_1042, _clm_1028, _clm_1027, _clm_1026, _clm_1023, _clm_1010, _clm_1004, G998, _clm_1000, _clm_999, _clm_988, _clm_960, _clm_940, _clm_920, _clm_915, _clm_903, _clm_897, G891, _clm_893, _clm_892, _clm_871, _clm_853, _clm_830, _clm_829, _clm_826, _clm_816, _clm_811, _clm_810, _clm_809, _clm_801, _clm_800, _clm_795, _clm_782, _clm_776, G770, _clm_772, _clm_771, _clm_758, _clm_738, _clm_707, _clm_706, _clm_703, _clm_687, _clm_681, G675, _clm_677, _clm_676, _clm_668, _clm_661, _clm_660, _clm_657, _clm_654, _clm_644, _clm_638, G632, _clm_634, _clm_633, _clm_623, _clm_617, G611, _clm_613, _clm_612, _clm_604, _clm_588, _clm_559, _clm_541, _clm_524, _clm_515, _clm_483, _clm_475, _clm_456, _clm_437, _clm_434, _clm_421, _clm_405, _clm_392, _clm_378, _clm_360, _clm_359, _clm_351, _clm_350, G338, _clm_341, _clm_340, _clm_327, _clm_307, _clm_287, _clm_267, _clm_253, _clm_238, _clm_222, _clm_198, _clm_176, _clm_161, _clm_140, _clm_134, G128, _clm_130, _clm_129, _clm_121, _clm_117, G111, _clm_113, _clm_105, G99, _clm_101, _clm_97, _clm_87, _clm_81, G75, _clm_77, _clm_76, _clm_55, _clm_30, _clm_19, _clm_13, _clm_10;
  double _clm_1169, LOOP_LIMIT_1142, _clm_1146, _clm_1135, _clm_1120, LOOP_LIMIT_1102, _clm_1066, _clm_1054, _clm_1053, _clm_1052, _clm_1051, A, _clm_1049, _clm_1048, _clm_1047, LOOP_LIMIT_1032, _clm_1029, _clm_1018, _clm_1012, _clm_1006, LOOP_LIMIT_975, _clm_905, _clm_899, _clm_817, _clm_784, _clm_778, _clm_725, _clm_696, _clm_689, _clm_683, _clm_667, _clm_646, _clm_640, _clm_625, _clm_619, _clm_600, _clm_589, _clm_566, _clm_563, LOOP_LIMIT_549, _clm_528, LOOP_LIMIT_505, LOOP_LIMIT_446, _clm_412, _clm_409, LOOP_LIMIT_395, _clm_386, _clm_281, _clm_276, _clm_272, LOOP_LIMIT_256, _clm_244, _clm_243, _clm_242, _clm_241, _clm_240, _clm_239, _clm_231, _clm_228, _clm_226, _clm_225, LOOP_LIMIT_211, FP, _clm_208, LOOP_LIMIT_188, F, _clm_184, LOOP_LIMIT_166, OS, _clm_154, _clm_142, _clm_136, _clm_89, RATIO, _clm_83, _clm_68, _clm_62, LOOP_LIMIT_45, B, _clm_38, J, _clm_24, _clm_23;
  mus_any *FIL = NULL;
  void *all_gens = NULL;
  mus_long_t clm_beg, clm_end;
  mus_long_t I_1; double J_1; mus_long_t K_1; 
  all_gens = clm_make_genbag();
  clm_beg = clm_to_mus_long_t(clm_int, 1);
  clm_end = clm_to_mus_long_t(clm_int, 3);
  I = clm_int[351];
  I_1 = clm_int[352];
  #define STATUS 5
  #define STATUS_r 0
  #define DEBUG 7
  #define DEBUG_r 1
  #define START 13
  #define START_r 4
  #define _clm_25 15
  #define _clm_25_r 5
  J = clm_double[173];
  J_1 = clm_double[174];
  #define WINDOWS 17
  #define WINDOWS_r 6
  #define P_COMPLETE 19
  #define P_COMPLETE_r 7
  #define FSR 21
  #define FSR_r 8
  #define CLOSEST 23
  #define CLOSEST_r 9
  #define CONTIG 25
  #define CONTIG_r 10
  #define _clm_42 27
  #define _clm_42_r 11
  #define _clm_43 29
  #define _clm_43_r 12
  #define BACKLOOKS 31
  #define BACKLOOKS_r 13
  #define BACKSTART 33
  #define BACKSTART_r 14
  B = clm_double[175];
  LOOP_LIMIT_45 = clm_double[176];
  #define _clm_58 35
  #define _clm_58_r 15
  #define FREQS 37
  #define FREQS_r 16
  #define THISY 39
  #define THISY_r 17
  #define _clm_60 43
  #define _clm_60_r 19
  #define LASTY 45
  #define LASTY_r 20
  #define _clm_71 47
  #define _clm_71_r 21
  #define _clm_78 49
  #define _clm_78_r 22
  #define _clm_82 51
  #define _clm_82_r 23
  #define _clm_84 53
  #define _clm_84_r 24
  #define MAX_JUMP_RATIO 55
  #define MAX_JUMP_RATIO_r 25
  #define _clm_100 57
  #define _clm_100_r 26
  #define MIN_FREQ 59
  #define MIN_FREQ_r 27
  #define _clm_102 61
  #define _clm_102_r 28
  #define MAX_FREQ 63
  #define MAX_FREQ_r 29
  #define G95 65
  #define G95_r 30
  #define _clm_106 67
  #define _clm_106_r 31
  #define _clm_109 69
  #define _clm_109_r 32
  #define _clm_112 71
  #define _clm_112_r 33
  #define _clm_114 73
  #define _clm_114_r 34
  #define G96 75
  #define G96_r 35
  #define _clm_118 77
  #define _clm_118_r 36
  #define _clm_124 79
  #define _clm_124_r 37
  #define _clm_131 81
  #define _clm_131_r 38
  #define _clm_135 83
  #define _clm_135_r 39
  #define _clm_137 85
  #define _clm_137_r 40
  OS = clm_double[177];
  #define MAX_SAMP_OFFSET 87
  #define MAX_SAMP_OFFSET_r 41
  LOOP_LIMIT_166 = clm_double[178];
  #define FILPTR 89
  #define FILPTR_r 42
  #define FDR 91
  #define FDR_r 43
  #define FDI 93
  #define FDI_r 44
  F = clm_double[179];
  #define MAX_FFTS 95
  #define MAX_FFTS_r 45
  LOOP_LIMIT_188 = clm_double[180];
  #define _clm_202 97
  #define _clm_202_r 46
  #define FFTSIZES 99
  #define FFTSIZES_r 47
  #define FFTSIZE 101
  #define FFTSIZE_r 48
  #define RMS_DIVISOR 103
  #define RMS_DIVISOR_r 49
  #define SUM_OF_SQUARES 105
  #define SUM_OF_SQUARES_r 50
  FP = clm_double[181];
  #define _clm_215 107
  #define _clm_215_r 51
  LOOP_LIMIT_211 = clm_double[182];
  if ((CLM_FILE2SAMPLE_P(109)) || (CLM_FILE2FRAMPLE_P(109)))
    FIL = clm_add_gen_to_genbag(all_gens, 
      mus_make_file_to_sample_with_buffer_size((char *)(clm_int + CLM_ILOC(109) + 2 + 2), clm_int[CLM_ILOC(109) + 1]));
  #define _clm_235 111
  #define _clm_235_r 53
  #define RMS 113
  #define RMS_r 54
  #define DB_FLOOR 115
  #define DB_FLOOR_r 55
  K = clm_int[355];
  K_1 = clm_int[356];
  #define _clm_260 117
  #define _clm_260_r 56
  LOOP_LIMIT_256 = clm_double[183];
  #define _clm_290 119
  #define _clm_290_r 57
  #define _clm_291 121
  #define _clm_291_r 58
  #define _clm_292 123
  #define _clm_292_r 59
  #define _clm_296 125
  #define _clm_296_r 60
  #define FWI2048 127
  #define FWI2048_r 61
  #define FWI1024 129
  #define FWI1024_r 62
  #define FWI4096 131
  #define FWI4096_r 63
  #define _clm_310 133
  #define _clm_310_r 64
  #define R 135
  #define R_r 65
  #define _clm_311 137
  #define _clm_311_r 66
  #define _clm_313 139
  #define _clm_313_r 67
  #define _clm_315 141
  #define _clm_315_r 68
  #define _clm_316 143
  #define _clm_316_r 69
  #define ZCROSSES 145
  #define ZCROSSES_r 70
  #define ZCROSSCT 147
  #define ZCROSSCT_r 71
  #define _clm_330 149
  #define _clm_330_r 72
  #define THIS 151
  #define THIS_r 73
  #define _clm_331 153
  #define _clm_331_r 74
  #define NEXT 155
  #define NEXT_r 75
  #define _clm_342 157
  #define _clm_342_r 76
  #define _clm_345 159
  #define _clm_345_r 77
  #define _clm_347 161
  #define _clm_347_r 78
  #define G339 163
  #define G339_r 79
  #define _clm_352 165
  #define _clm_352_r 80
  #define _clm_356 167
  #define _clm_356_r 81
  #define _clm_379 169
  #define _clm_379_r 82
  #define _clm_382 171
  #define _clm_382_r 83
  #define THISX 173
  #define THISX_r 84
  #define _clm_383 175
  #define _clm_383_r 85
  #define NEXTX 177
  #define NEXTX_r 86
  #define _clm_387 179
  #define _clm_387_r 87
  #define _clm_388 181
  #define _clm_388_r 88
  #define TWEENY 183
  #define TWEENY_r 89
  LOOP_LIMIT_395 = clm_double[184];
  #define _clm_408 185
  #define _clm_408_r 90
  #define LOWFQ_WARN_FLAG 187
  #define LOWFQ_WARN_FLAG_r 91
  #define PEAKS 189
  #define PEAKS_r 92
  #define PEAKSCT 191
  #define PEAKSCT_r 93
  LOOP_LIMIT_446 = clm_double[185];
  #define _clm_460 193
  #define _clm_460_r 94
  #define _clm_462 195
  #define _clm_462_r 95
  #define MAXY 197
  #define MAXY_r 96
  #define MAXX 199
  #define MAXX_r 97
  #define _clm_478 201
  #define _clm_478_r 98
  MAXPEAKINDEX = clm_int[359];
  #define MAXPEAKY 203
  #define MAXPEAKY_r 99
  #define _clm_503 205
  #define _clm_503_r 100
  #define LEFTY 207
  #define LEFTY_r 101
  LOOP_LIMIT_505 = clm_double[186];
  #define _clm_519 209
  #define _clm_519_r 102
  #define _clm_520 211
  #define _clm_520_r 103
  #define PEAKY 213
  #define PEAKY_r 104
  #define _clm_536 215
  #define _clm_536_r 105
  LOOP_LIMIT_549 = clm_double[187];
  #define _clm_562 217
  #define _clm_562_r 106
  #define _clm_573 219
  #define _clm_573_r 107
  #define _clm_575 221
  #define _clm_575_r 108
  #define PEAK 223
  #define PEAK_r 109
  #define WINFREQ 225
  #define WINFREQ_r 110
  #define _clm_585 227
  #define _clm_585_r 111
  #define _clm_599 229
  #define _clm_599_r 112
  #define _clm_607 231
  #define _clm_607_r 113
  #define _clm_614 233
  #define _clm_614_r 114
  #define _clm_618 235
  #define _clm_618_r 115
  #define _clm_620 237
  #define _clm_620_r 116
  #define _clm_628 239
  #define _clm_628_r 117
  #define _clm_635 241
  #define _clm_635_r 118
  #define _clm_639 243
  #define _clm_639_r 119
  #define _clm_641 245
  #define _clm_641_r 120
  #define _clm_662 247
  #define _clm_662_r 121
  #define _clm_665 249
  #define _clm_665_r 122
  #define _clm_666 251
  #define _clm_666_r 123
  #define _clm_671 253
  #define _clm_671_r 124
  #define _clm_678 255
  #define _clm_678_r 125
  #define _clm_682 257
  #define _clm_682_r 126
  #define _clm_684 259
  #define _clm_684_r 127
  #define FINISH 261
  #define FINISH_r 128
  #define INCRSAMPS 263
  #define INCRSAMPS_r 129
  #define END 265
  #define END_r 130
  #define POST_PROCESS 269
  #define POST_PROCESS_r 132
  #define MAX_FILTER_CANDIDATES 271
  #define MAX_FILTER_CANDIDATES_r 133
  #define MAX_CANDIDATES 273
  #define MAX_CANDIDATES_r 134
  #define _clm_761 277
  #define _clm_761_r 136
  #define _clm_762 279
  #define _clm_762_r 137
  #define PREVY 281
  #define PREVY_r 138
  #define _clm_766 283
  #define _clm_766_r 139
  #define _clm_773 285
  #define _clm_773_r 140
  #define _clm_777 287
  #define _clm_777_r 141
  #define _clm_779 289
  #define _clm_779_r 142
  #define _clm_797 291
  #define _clm_797_r 143
  #define G794 293
  #define G794_r 144
  #define _clm_802 295
  #define _clm_802_r 145
  #define _clm_806 297
  #define _clm_806_r 146
  #define _clm_833 299
  #define _clm_833_r 147
  #define ENDMINUS 301
  #define ENDMINUS_r 148
  #define _clm_834 303
  #define _clm_834_r 149
  #define _clm_835 305
  #define _clm_835_r 150
  #define CANDEND 307
  #define CANDEND_r 151
  M = clm_int[361];
  N = clm_int[363];
  LOOP_LIMIT_861 = clm_int[365];
  #define _clm_882 309
  #define _clm_882_r 152
  #define _clm_883 311
  #define _clm_883_r 153
  #define NEXTY 313
  #define NEXTY_r 154
  #define _clm_887 315
  #define _clm_887_r 155
  #define _clm_894 317
  #define _clm_894_r 156
  #define _clm_898 319
  #define _clm_898_r 157
  #define _clm_900 321
  #define _clm_900_r 158
  #define THISR 323
  #define THISR_r 159
  LOOP_LIMIT_975 = clm_double[188];
  #define C 325
  #define C_r 160
  #define _clm_991 327
  #define _clm_991_r 161
  #define CAND 329
  #define CAND_r 162
  #define _clm_994 331
  #define _clm_994_r 163
  #define _clm_1001 333
  #define _clm_1001_r 164
  #define _clm_1005 335
  #define _clm_1005_r 165
  #define _clm_1007 337
  #define _clm_1007_r 166
  #define CRATIO 339
  #define CRATIO_r 167
  LOOP_LIMIT_1032 = clm_double[189];
  #define _clm_1046 341
  #define _clm_1046_r 168
  #define INTER 343
  #define INTER_r 169
  LOOP_LIMIT_1102 = clm_double[190];
  #define _clm_1136 345
  #define _clm_1136_r 170
  #define _clm_1156 347
  #define _clm_1156_r 171
  #define _clm_1178 349
  #define _clm_1178_r 172
  if (clm_beg > clm_end) return(1);
  got_sigint = 0; old_SIGINT = clm_signal(SIGINT, sig_err);                     /* trap SIGINT */
  I = clm_beg;                                                                  /* pass counter */

SAMPLE_LOOP_BEGIN:
  if (got_sigint != 0) {clm_int[0] = (int)got_sigint; goto RUN_ALL_DONE;}
  if (I > clm_end) {I = clm_end; goto RUN_ALL_DONE;}
                                                                                /* (progn */
                                                                                /* (if (and status (not debug)) */
                                                                                /* (if status */
  if (((clm_int[STATUS] == 0) && (clm_int[STATUS + 1] == 0))) goto L_11;
  _clm_13 = ((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0));               /* (null DEBUG) */
  _clm_10 = _clm_13;                                                            /* (setf _clm_10 _clm_13) */
  goto L_12;
L_11:
  _clm_10 = 0;                                                                  /* (setf _clm_10 NIL) */
L_12:
  if ((!_clm_10)) goto L_7;
                                                                                /* (progn */
                                                                                /* (if (= i start) */
  _clm_19 = (I == ((clm_int[START] == 2) ? clm_double[START_r] : (double)(clm_int[START + 1]))); /* (== I START) */
  if ((!_clm_19)) goto L_17;
                                                                                /* (clm-print "~%autoc percent complete: " ) */
  mus_error(0, "\nautoc percent complete: ");
  goto L_18;
L_17:
L_18:
  clm_int[_clm_25 + 0] = 2;
  clm_double[_clm_25_r+0] = J + 1.0;
  _clm_24 = ((double)((clm_int[_clm_25] == 2) ? clm_double[_clm_25_r] : (double)(clm_int[_clm_25 + 1])) / (double)((((clm_int[WINDOWS] == 2) ? clm_double[WINDOWS_r] : (double)(clm_int[WINDOWS + 1])))));
                                                                                /* (/ _clm_25 windows) */
                                                                                /* (* _clm_24 100) */
  _clm_23 = ((_clm_24) * (100));
  _clm_22 = (mus_long_t)floor((double)((_clm_23) + .5));                        /* (round _clm_23) */
  if ( (((_clm_22) - (_clm_23)) == .5) && (((mus_long_t)(_clm_22)) & 1) ) _clm_22 -= 1;;
  NC = _clm_22;                                                                 /* (setf NC _clm_22) */
                                                                                /* (if (> nc p-complete) */
  _clm_30 = (NC > ((clm_int[P_COMPLETE] == 2) ? clm_double[P_COMPLETE_r] : (double)(clm_int[P_COMPLETE + 1]))); /* (> NC P-COMPLETE) */
  if ((!_clm_30)) goto L_28;
                                                                                /* (progn */
                                                                                /* (clm-print "~D "  NC) */
  mus_error(0, "%" PRId64"  ",
        (mus_long_t)NC);
  clm_int[P_COMPLETE + 0] = 1;
  clm_int[P_COMPLETE + 0 + 1] = NC;                                             /* (setf P-COMPLETE NC) */
  goto L_29;
L_28:
L_29:
  goto L_8;
L_7:
L_8:
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_35;
  _clm_38 = ((double)I / (double)((((clm_int[FSR] == 2) ? clm_double[FSR_r] : (double)(clm_int[FSR + 1])))));
                                                                                /* (/ I fsr) */
                                                                                /* (clm-print "~%Window #~D, ~F sec., file frame ~D --------------~%"  J _clm_38 I) */
  mus_error(0, "\nWindow #%" PRId64" , %f sec., file frame %" PRId64"  --------------\n",
        (mus_long_t)J,
        (double)_clm_38,
        (mus_long_t)I);
  goto L_36;
L_35:
L_36:
  clm_int[CLOSEST + 0] = 0;
  clm_int[CLOSEST + 0 + 1] = 0;                                                 /* (setf CLOSEST NIL) */
  clm_int[CONTIG + 0] = 0;
  clm_int[CONTIG + 0 + 1] = 1;                                                  /* (setf CONTIG T) */
                                                                                /* (- j backlooks) */
  clm_int[_clm_43 + 0] = 2;
  clm_double[_clm_43_r+0] = ((J) - (((clm_int[BACKLOOKS] == 2) ? clm_double[BACKLOOKS_r] : (double)(clm_int[BACKLOOKS + 1]))));
  clm_int[_clm_42 + 0] = 2;
  clm_double[_clm_42_r+0] = ((1 > ((clm_int[_clm_43] == 2) ? clm_double[_clm_43_r] : (double)(clm_int[_clm_43 + 1]))) ? 1 : ((clm_int[_clm_43] == 2) ? clm_double[_clm_43_r] : (double)(clm_int[_clm_43 + 1]))); /* (max 1 _clm_43) */
  clm_int[BACKSTART + 0] = clm_int[_clm_42 + 0];
  clm_int[BACKSTART + 0 + 1] = clm_int[_clm_42 + 0 + 1];
  clm_double[BACKSTART_r + 0] = clm_double[_clm_42_r + 0];                      /* (setf BACKSTART _clm_42) */
  B = ((clm_int[BACKSTART] == 2) ? clm_double[BACKSTART_r] : (double)(clm_int[BACKSTART + 1])); /* (setf B BACKSTART) */
  LOOP_LIMIT_45 = J;                                                            /* (setf LOOP-LIMIT-45 J) */
                                                                                /* (tagbody */
NEXT_LOOP_L_55:
                                                                                /* (if (>= b loop-limit-45) */
  _clm_55 = (B >= LOOP_LIMIT_45);                                               /* (>= B LOOP-LIMIT-45) */
  if ((!_clm_55)) goto L_53;
                                                                                /* (go end-loop */
  goto END_LOOP_L_55;
  goto L_54;
L_53:
L_54:
  _clm_59 = (mus_long_t)floor((double)(B));                                     /* (floor B) */
  {int lci; lci = _clm_59;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_58 + 0] = 2;
  clm_double[_clm_58_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_58 + 0] = 1;
  clm_int[_clm_58 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_58 + 0] = clm_int[iblock];
      clm_int[_clm_58 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_58_r + 0] = clm_double[rblock];
  }}}

  clm_int[THISY + 0] = clm_int[_clm_58 + 0];
  clm_int[THISY + 0 + 1] = clm_int[_clm_58 + 0 + 1];
  clm_double[THISY_r + 0] = clm_double[_clm_58_r + 0];                          /* (setf THISY _clm_58) */
  _clm_62 = B - 1.0;
  _clm_61 = (mus_long_t)floor((double)(_clm_62));                               /* (floor _clm_62) */
  {int lci; lci = _clm_61;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_60 + 0] = 2;
  clm_double[_clm_60_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_60 + 0] = 1;
  clm_int[_clm_60 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_60 + 0] = clm_int[iblock];
      clm_int[_clm_60 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_60_r + 0] = clm_double[rblock];
  }}}

  clm_int[LASTY + 0] = clm_int[_clm_60 + 0];
  clm_int[LASTY + 0 + 1] = clm_int[_clm_60 + 0 + 1];
  clm_double[LASTY_r + 0] = clm_double[_clm_60_r + 0];                          /* (setf LASTY _clm_60) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_65;
  _clm_68 = B - 1.0;
                                                                                /* (progn */
                                                                                /* (if (or (zerop lasty) (zerop thisy)) */
    if (clm_int[LASTY + 0]==1) _clm_77 = (clm_int[LASTY + 0 + 1] == 0); else _clm_77 = (clm_double[LASTY_r+0] == 0.0);
;                                                                               /* (zerop LASTY) */
  G75 = _clm_77;                                                                /* (setf G75 _clm_77) */
                                                                                /* (if g75 */
  if ((!G75)) goto L_79;
  clm_int[_clm_78 + 0] = 0;
  clm_int[_clm_78 + 0 + 1] = G75;                                               /* (setf _clm_78 G75) */
  goto L_80;
L_79:
    if (clm_int[THISY + 0]==1) _clm_81 = (clm_int[THISY + 0 + 1] == 0); else _clm_81 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  clm_int[_clm_78 + 0] = 0;
  clm_int[_clm_78 + 0 + 1] = _clm_81;                                           /* (setf _clm_78 _clm_81) */
L_80:
  _clm_76 = ((clm_int[_clm_78] == 2) ? clm_double[_clm_78_r] : (double)(clm_int[_clm_78 + 1])); /* (setf _clm_76 _clm_78) */
  if ((!_clm_76)) goto L_72;
  clm_int[_clm_71 + 0] = 1;
  clm_int[_clm_71 + 0 + 1] = 0;                                                 /* (setf _clm_71 0) */
  goto L_73;
L_72:
  _clm_83 = ((double)((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) / (double)((((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])))));
                                                                                /* (/ THISY lasty) */
  RATIO = _clm_83;                                                              /* (setf RATIO _clm_83) */
                                                                                /* (if (< ratio 1.0) */
  _clm_87 = (RATIO < 1.0);                                                      /* (< RATIO 1.0) */
  if ((!_clm_87)) goto L_85;
  _clm_89 = (1.0 / (double)RATIO);                                              /* (/ RATIO) */
  RATIO = _clm_89;                                                              /* (setf RATIO _clm_89) */
  clm_int[_clm_84 + 0] = 2;
  clm_double[_clm_84_r+0] = _clm_89;                                            /* (setf _clm_84 _clm_89) */
  goto L_86;
L_85:
  clm_int[_clm_84 + 0] = 2;
  clm_double[_clm_84_r+0] = RATIO;                                              /* (setf _clm_84 RATIO) */
L_86:
  clm_int[_clm_82 + 0] = clm_int[_clm_84 + 0];
  clm_int[_clm_82 + 0 + 1] = clm_int[_clm_84 + 0 + 1];
  clm_double[_clm_82_r + 0] = clm_double[_clm_84_r + 0];                        /* (setf _clm_82 _clm_84) */
  clm_int[_clm_71 + 0] = clm_int[_clm_82 + 0];
  clm_int[_clm_71 + 0 + 1] = clm_int[_clm_82 + 0 + 1];
  clm_double[_clm_71_r + 0] = clm_double[_clm_82_r + 0];                        /* (setf _clm_71 _clm_82) */
L_73:
                                                                                /* (clm-print "Compare win#~D, ~F and win#~D, ~F ratio = ~F cf ~F~%"  _clm_68 LASTY B THISY _clm_71 MAX-JUMP-RATIO) */
  mus_error(0, "Compare win#%" PRId64" , %f and win#%" PRId64" , %f ratio = %f cf %f\n",
        (mus_long_t)_clm_68,
        (double)((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])),
        (mus_long_t)B,
        (double)((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])),
        (double)((clm_int[_clm_71] == 2) ? clm_double[_clm_71_r] : (double)(clm_int[_clm_71 + 1])),
        (double)((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1])));
  goto L_66;
L_65:
L_66:
                                                                                /* (if (or (or (< lasty min-freq) (> lasty max-freq))
     (or (< thisy min-freq) (> thisy max-freq))
     (> (ac-get-ratio lasty thisy) max-jump-ratio)) */
  _clm_101 = (((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])) < ((clm_int[MIN_FREQ] == 2) ? clm_double[MIN_FREQ_r] : (double)(clm_int[MIN_FREQ + 1]))); /* (< LASTY MIN-FREQ) */
  G99 = _clm_101;                                                               /* (setf G99 _clm_101) */
                                                                                /* (if g99 */
  if ((!G99)) goto L_103;
  clm_int[_clm_102 + 0] = 0;
  clm_int[_clm_102 + 0 + 1] = G99;                                              /* (setf _clm_102 G99) */
  goto L_104;
L_103:
  _clm_105 = (((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])) > ((clm_int[MAX_FREQ] == 2) ? clm_double[MAX_FREQ_r] : (double)(clm_int[MAX_FREQ + 1]))); /* (> LASTY MAX-FREQ) */
  clm_int[_clm_102 + 0] = 0;
  clm_int[_clm_102 + 0 + 1] = _clm_105;                                         /* (setf _clm_102 _clm_105) */
L_104:
  clm_int[_clm_100 + 0] = clm_int[_clm_102 + 0];
  clm_int[_clm_100 + 0 + 1] = clm_int[_clm_102 + 0 + 1];
  clm_double[_clm_100_r + 0] = clm_double[_clm_102_r + 0];                      /* (setf _clm_100 _clm_102) */
  clm_int[G95 + 0] = clm_int[_clm_100 + 0];
  clm_int[G95 + 0 + 1] = clm_int[_clm_100 + 0 + 1];
  clm_double[G95_r + 0] = clm_double[_clm_100_r + 0];                           /* (setf G95 _clm_100) */
                                                                                /* (if g95 */
  if (((clm_int[G95] == 0) && (clm_int[G95 + 1] == 0))) goto L_107;
  clm_int[_clm_106 + 0] = clm_int[G95 + 0];
  clm_int[_clm_106 + 0 + 1] = clm_int[G95 + 0 + 1];
  clm_double[_clm_106_r + 0] = clm_double[G95_r + 0];                           /* (setf _clm_106 G95) */
  goto L_108;
L_107:
  _clm_113 = (((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) < ((clm_int[MIN_FREQ] == 2) ? clm_double[MIN_FREQ_r] : (double)(clm_int[MIN_FREQ + 1]))); /* (< THISY MIN-FREQ) */
  G111 = _clm_113;                                                              /* (setf G111 _clm_113) */
                                                                                /* (if g111 */
  if ((!G111)) goto L_115;
  clm_int[_clm_114 + 0] = 0;
  clm_int[_clm_114 + 0 + 1] = G111;                                             /* (setf _clm_114 G111) */
  goto L_116;
L_115:
  _clm_117 = (((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) > ((clm_int[MAX_FREQ] == 2) ? clm_double[MAX_FREQ_r] : (double)(clm_int[MAX_FREQ + 1]))); /* (> THISY MAX-FREQ) */
  clm_int[_clm_114 + 0] = 0;
  clm_int[_clm_114 + 0 + 1] = _clm_117;                                         /* (setf _clm_114 _clm_117) */
L_116:
  clm_int[_clm_112 + 0] = clm_int[_clm_114 + 0];
  clm_int[_clm_112 + 0 + 1] = clm_int[_clm_114 + 0 + 1];
  clm_double[_clm_112_r + 0] = clm_double[_clm_114_r + 0];                      /* (setf _clm_112 _clm_114) */
  clm_int[G96 + 0] = clm_int[_clm_112 + 0];
  clm_int[G96 + 0 + 1] = clm_int[_clm_112 + 0 + 1];
  clm_double[G96_r + 0] = clm_double[_clm_112_r + 0];                           /* (setf G96 _clm_112) */
                                                                                /* (if g96 */
  if (((clm_int[G96] == 0) && (clm_int[G96 + 1] == 0))) goto L_119;
  clm_int[_clm_118 + 0] = clm_int[G96 + 0];
  clm_int[_clm_118 + 0 + 1] = clm_int[G96 + 0 + 1];
  clm_double[_clm_118_r + 0] = clm_double[G96_r + 0];                           /* (setf _clm_118 G96) */
  goto L_120;
L_119:
                                                                                /* (progn */
                                                                                /* (if (or (zerop lasty) (zerop thisy)) */
    if (clm_int[LASTY + 0]==1) _clm_130 = (clm_int[LASTY + 0 + 1] == 0); else _clm_130 = (clm_double[LASTY_r+0] == 0.0);
;                                                                               /* (zerop LASTY) */
  G128 = _clm_130;                                                              /* (setf G128 _clm_130) */
                                                                                /* (if g128 */
  if ((!G128)) goto L_132;
  clm_int[_clm_131 + 0] = 0;
  clm_int[_clm_131 + 0 + 1] = G128;                                             /* (setf _clm_131 G128) */
  goto L_133;
L_132:
    if (clm_int[THISY + 0]==1) _clm_134 = (clm_int[THISY + 0 + 1] == 0); else _clm_134 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  clm_int[_clm_131 + 0] = 0;
  clm_int[_clm_131 + 0 + 1] = _clm_134;                                         /* (setf _clm_131 _clm_134) */
L_133:
  _clm_129 = ((clm_int[_clm_131] == 2) ? clm_double[_clm_131_r] : (double)(clm_int[_clm_131 + 1])); /* (setf _clm_129 _clm_131) */
  if ((!_clm_129)) goto L_125;
  clm_int[_clm_124 + 0] = 1;
  clm_int[_clm_124 + 0 + 1] = 0;                                                /* (setf _clm_124 0) */
  goto L_126;
L_125:
  _clm_136 = ((double)((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) / (double)((((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])))));
                                                                                /* (/ THISY lasty) */
  RATIO = _clm_136;                                                             /* (setf RATIO _clm_136) */
                                                                                /* (if (< ratio 1.0) */
  _clm_140 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_140)) goto L_138;
  _clm_142 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_142;                                                             /* (setf RATIO _clm_142) */
  clm_int[_clm_137 + 0] = 2;
  clm_double[_clm_137_r+0] = _clm_142;                                          /* (setf _clm_137 _clm_142) */
  goto L_139;
L_138:
  clm_int[_clm_137 + 0] = 2;
  clm_double[_clm_137_r+0] = RATIO;                                             /* (setf _clm_137 RATIO) */
L_139:
  clm_int[_clm_135 + 0] = clm_int[_clm_137 + 0];
  clm_int[_clm_135 + 0 + 1] = clm_int[_clm_137 + 0 + 1];
  clm_double[_clm_135_r + 0] = clm_double[_clm_137_r + 0];                      /* (setf _clm_135 _clm_137) */
  clm_int[_clm_124 + 0] = clm_int[_clm_135 + 0];
  clm_int[_clm_124 + 0 + 1] = clm_int[_clm_135 + 0 + 1];
  clm_double[_clm_124_r + 0] = clm_double[_clm_135_r + 0];                      /* (setf _clm_124 _clm_135) */
L_126:
  _clm_121 = (((clm_int[_clm_124] == 2) ? clm_double[_clm_124_r] : (double)(clm_int[_clm_124 + 1])) > ((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))); /* (> _clm_124 MAX-JUMP-RATIO) */
  clm_int[_clm_118 + 0] = 0;
  clm_int[_clm_118 + 0 + 1] = _clm_121;                                         /* (setf _clm_118 _clm_121) */
L_120:
  clm_int[_clm_109 + 0] = clm_int[_clm_118 + 0];
  clm_int[_clm_109 + 0 + 1] = clm_int[_clm_118 + 0 + 1];
  clm_double[_clm_109_r + 0] = clm_double[_clm_118_r + 0];                      /* (setf _clm_109 _clm_118) */
  clm_int[_clm_106 + 0] = clm_int[_clm_109 + 0];
  clm_int[_clm_106 + 0 + 1] = clm_int[_clm_109 + 0 + 1];
  clm_double[_clm_106_r + 0] = clm_double[_clm_109_r + 0];                      /* (setf _clm_106 _clm_109) */
L_108:
  _clm_97 = ((clm_int[_clm_106] == 2) ? clm_double[_clm_106_r] : (double)(clm_int[_clm_106 + 1])); /* (setf _clm_97 _clm_106) */
  if ((!_clm_97)) goto L_92;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_146;
                                                                                /* (clm-print "Previous points not contiguous.~%" ) */
  mus_error(0, "Previous points not contiguous.\n");
  goto L_147;
L_146:
L_147:
  clm_int[CONTIG + 0] = 0;
  clm_int[CONTIG + 0 + 1] = 0;                                                  /* (setf CONTIG NIL) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_55;
  goto L_93;
L_92:
L_93:
  _clm_154 = B + 1.0;
  B = _clm_154;                                                                 /* (setf B _clm_154) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_55;
END_LOOP_L_55:
                                                                                /* (block nil */
                                                                                /* (if (and debug contig) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_162;
  _clm_161 = ((clm_int[CONTIG] == 2) ? clm_double[CONTIG_r] : (double)(clm_int[CONTIG + 1])); /* (setf _clm_161 CONTIG) */
  goto L_163;
L_162:
  _clm_161 = 0;                                                                 /* (setf _clm_161 NIL) */
L_163:
  if ((!_clm_161)) goto L_158;
                                                                                /* (clm-print "Previous points contiguous.~%" ) */
  mus_error(0, "Previous points contiguous.\n");
  goto L_159;
L_158:
L_159:
  OS = 0;                                                                       /* (setf OS 0) */
  LOOP_LIMIT_166 = ((clm_int[MAX_SAMP_OFFSET] == 2) ? clm_double[MAX_SAMP_OFFSET_r] : (double)(clm_int[MAX_SAMP_OFFSET + 1])); /* (setf LOOP-LIMIT-166 MAX-SAMP-OFFSET) */
                                                                                /* (tagbody */
NEXT_LOOP_L_56:
                                                                                /* (if (> os loop-limit-166) */
  _clm_176 = (OS > LOOP_LIMIT_166);                                             /* (> OS LOOP-LIMIT-166) */
  if ((!_clm_176)) goto L_174;
                                                                                /* (go end-loop */
  goto END_LOOP_L_56;
  goto L_175;
L_174:
L_175:
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_180;
                                                                                /* (clm-print "~%Trying sample offset ~D~%"  OS) */
  mus_error(0, "\nTrying sample offset %" PRId64" \n",
        (mus_long_t)OS);
  goto L_181;
L_180:
L_181:
                                                                                /* (+ i os) */
  _clm_184 = ((I) + (OS));
  clm_int[FILPTR + 0] = 2;
  clm_double[FILPTR_r+0] = _clm_184;                                            /* (setf FILPTR _clm_184) */
  memset((void *)((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]))), 0, (CLM_ARR_SIZE(clm_int[FDR + 0 + 1])) * sizeof(mus_float_t));
  memset((void *)((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1]))), 0, (CLM_ARR_SIZE(clm_int[FDI + 0 + 1])) * sizeof(mus_float_t));
  F = 0;                                                                        /* (setf F 0) */
  LOOP_LIMIT_188 = ((clm_int[MAX_FFTS] == 2) ? clm_double[MAX_FFTS_r] : (double)(clm_int[MAX_FFTS + 1])); /* (setf LOOP-LIMIT-188 MAX-FFTS) */
                                                                                /* (tagbody */
NEXT_LOOP_L_57:
                                                                                /* (if (>= f loop-limit-188) */
  _clm_198 = (F >= LOOP_LIMIT_188);                                             /* (>= F LOOP-LIMIT-188) */
  if ((!_clm_198)) goto L_196;
                                                                                /* (go end-loop */
  goto END_LOOP_L_57;
  goto L_197;
L_196:
L_197:
                                                                                /* (progn */
  {int lci; lci = F;
  switch (CLM_ARR_TYPE(clm_int[FFTSIZES + 0 + 1]))
    {
    case 36: clm_int[_clm_202 + 0] = 2;
  clm_double[_clm_202_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FFTSIZES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_202 + 0] = 1;
  clm_int[_clm_202 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FFTSIZES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FFTSIZES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FFTSIZES + 0 + 1]) + lci;
      clm_int[_clm_202 + 0] = clm_int[iblock];
      clm_int[_clm_202 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_202_r + 0] = clm_double[rblock];
  }}}

  clm_int[FFTSIZE + 0] = clm_int[_clm_202 + 0];
  clm_int[FFTSIZE + 0 + 1] = clm_int[_clm_202 + 0 + 1];
  clm_double[FFTSIZE_r + 0] = clm_double[_clm_202_r + 0];                       /* (setf FFTSIZE _clm_202) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_204;
                                                                                /* (clm-print "~%Trying fftsize ~D~%"  FFTSIZE) */
  mus_error(0, "\nTrying fftsize %" PRId64" \n",
        (mus_long_t)((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1])));
  goto L_205;
L_204:
L_205:
  _clm_208 = sqrt((double)(((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1])))); /* (sqrt FFTSIZE) */
  clm_int[RMS_DIVISOR + 0] = 2;
  clm_double[RMS_DIVISOR_r+0] = _clm_208;                                       /* (setf RMS-DIVISOR _clm_208) */
  clm_int[SUM_OF_SQUARES + 0] = 1;
  clm_int[SUM_OF_SQUARES + 0 + 1] = 0;                                          /* (setf SUM-OF-SQUARES 0) */
  FP = ((clm_int[FILPTR] == 2) ? clm_double[FILPTR_r] : (double)(clm_int[FILPTR + 1])); /* (setf FP FILPTR) */
                                                                                /* (+ filptr fftsize) */
  if ((clm_int[FILPTR + 0] == 1) && (clm_int[FFTSIZE + 0] == 1))
    {clm_int[_clm_215 + 0] = 1;
  clm_int[_clm_215 + 0 + 1] = ((clm_int[FILPTR + 0 + 1]) + (clm_int[FFTSIZE + 0 + 1]));}
  else {clm_int[_clm_215 + 0] = 2;
  clm_double[_clm_215_r+0] = ((((clm_int[FILPTR] == 2) ? clm_double[FILPTR_r] : (double)(clm_int[FILPTR + 1]))) + (((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1]))));}
  LOOP_LIMIT_211 = ((clm_int[_clm_215] == 2) ? clm_double[_clm_215_r] : (double)(clm_int[_clm_215 + 1])); /* (setf LOOP-LIMIT-211 _clm_215) */
                                                                                /* (tagbody */
NEXT_LOOP_L_58:
                                                                                /* (if (> fp loop-limit-211) */
  _clm_222 = (FP > LOOP_LIMIT_211);                                             /* (> FP LOOP-LIMIT-211) */
  if ((!_clm_222)) goto L_220;
                                                                                /* (go end-loop */
  goto END_LOOP_L_58;
  goto L_221;
L_220:
L_221:
  _clm_228 = mus_in_any(FP, 0, FIL);
  _clm_226 = pow((double)(_clm_228), (double)(2));                              /* (expt _clm_228 2) */
                                                                                /* (+ sum-of-squares _clm_226) */
  _clm_225 = ((((clm_int[SUM_OF_SQUARES] == 2) ? clm_double[SUM_OF_SQUARES_r] : (double)(clm_int[SUM_OF_SQUARES + 1]))) + (_clm_226));
  clm_int[SUM_OF_SQUARES + 0] = 2;
  clm_double[SUM_OF_SQUARES_r+0] = _clm_225;                                    /* (setf SUM-OF-SQUARES _clm_225) */
  _clm_231 = FP + 1.0;
  FP = _clm_231;                                                                /* (setf FP _clm_231) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_58;
END_LOOP_L_58:
                                                                                /* (block nil */
                                                                                /* (if (< (sqrt (/ sum-of-squares rms-divisor)) 1.0e-5) */
  _clm_240 = ((double)((clm_int[SUM_OF_SQUARES] == 2) ? clm_double[SUM_OF_SQUARES_r] : (double)(clm_int[SUM_OF_SQUARES + 1])) / (double)((((clm_int[RMS_DIVISOR] == 2) ? clm_double[RMS_DIVISOR_r] : (double)(clm_int[RMS_DIVISOR + 1])))));
                                                                                /* (/ SUM-OF-SQUARES rms-divisor) */
  _clm_239 = sqrt((double)(_clm_240));                                          /* (sqrt _clm_240) */
  _clm_238 = (_clm_239 < 1.0e-5);                                               /* (< _clm_239 1.0e-5) */
  if ((!_clm_238)) goto L_236;
  clm_int[_clm_235 + 0] = 1;
  clm_int[_clm_235 + 0 + 1] = -100;                                             /* (setf _clm_235 -100) */
  goto L_237;
L_236:
  _clm_244 = ((double)((clm_int[SUM_OF_SQUARES] == 2) ? clm_double[SUM_OF_SQUARES_r] : (double)(clm_int[SUM_OF_SQUARES + 1])) / (double)((((clm_int[RMS_DIVISOR] == 2) ? clm_double[RMS_DIVISOR_r] : (double)(clm_int[RMS_DIVISOR + 1])))));
                                                                                /* (/ SUM-OF-SQUARES rms-divisor) */
  _clm_243 = sqrt((double)(_clm_244));                                          /* (sqrt _clm_244) */
  _clm_242 = log((double)(_clm_243)) / 2.3025851;                               /* (log _clm_243 10.0) */
                                                                                /* (* 20 _clm_242) */
  _clm_241 = ((20) * (_clm_242));
  clm_int[_clm_235 + 0] = 2;
  clm_double[_clm_235_r+0] = _clm_241;                                          /* (setf _clm_235 _clm_241) */
L_237:
  clm_int[RMS + 0] = clm_int[_clm_235 + 0];
  clm_int[RMS + 0 + 1] = clm_int[_clm_235 + 0 + 1];
  clm_double[RMS_r + 0] = clm_double[_clm_235_r + 0];                           /* (setf RMS _clm_235) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_247;
                                                                                /* (clm-print "~F dB peak~%"  RMS) */
  mus_error(0, "%f dB peak\n",
        (double)((clm_int[RMS] == 2) ? clm_double[RMS_r] : (double)(clm_int[RMS + 1])));
  goto L_248;
L_247:
L_248:
                                                                                /* (if (>= rms db-floor) */
  _clm_253 = (((clm_int[RMS] == 2) ? clm_double[RMS_r] : (double)(clm_int[RMS + 1])) >= ((clm_int[DB_FLOOR] == 2) ? clm_double[DB_FLOOR_r] : (double)(clm_int[DB_FLOOR + 1]))); /* (>= RMS DB-FLOOR) */
  if ((!_clm_253)) goto L_251;
  K = 0;                                                                        /* (setf K 0) */
  FP = ((clm_int[FILPTR] == 2) ? clm_double[FILPTR_r] : (double)(clm_int[FILPTR + 1])); /* (setf FP FILPTR) */
                                                                                /* (+ filptr fftsize) */
  if ((clm_int[FILPTR + 0] == 1) && (clm_int[FFTSIZE + 0] == 1))
    {clm_int[_clm_260 + 0] = 1;
  clm_int[_clm_260 + 0 + 1] = ((clm_int[FILPTR + 0 + 1]) + (clm_int[FFTSIZE + 0 + 1]));}
  else {clm_int[_clm_260 + 0] = 2;
  clm_double[_clm_260_r+0] = ((((clm_int[FILPTR] == 2) ? clm_double[FILPTR_r] : (double)(clm_int[FILPTR + 1]))) + (((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1]))));}
  LOOP_LIMIT_256 = ((clm_int[_clm_260] == 2) ? clm_double[_clm_260_r] : (double)(clm_int[_clm_260 + 1])); /* (setf LOOP-LIMIT-256 _clm_260) */
                                                                                /* (tagbody */
NEXT_LOOP_L_59:
                                                                                /* (if (> fp loop-limit-256) */
  _clm_267 = (FP > LOOP_LIMIT_256);                                             /* (> FP LOOP-LIMIT-256) */
  if ((!_clm_267)) goto L_265;
                                                                                /* (go end-loop */
  goto END_LOOP_L_59;
  goto L_266;
L_265:
L_266:
                                                                                /* (progn */
  _clm_272 = mus_in_any(FP, 0, FIL);
  {int lci; lci = K;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci] = _clm_272; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci] = _clm_272; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[iblock] = 2; clm_double[rblock] = _clm_272;
  }}}

  K += 1;                                                                       /* (incf K 1) */
  _clm_276 = FP + 1.0;
  FP = _clm_276;                                                                /* (setf FP _clm_276) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_59;
END_LOOP_L_59:
                                                                                /* (block nil */
  _clm_281 = ((double)((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1])) / (double)((2)));
                                                                                /* (/ FFTSIZE 2) */
  _clm_280 = (mus_long_t)floor((double)(_clm_281));                             /* (floor _clm_281) */
  FFT2 = _clm_280;                                                              /* (setf FFT2 _clm_280) */
  clm_int[DEBUG + 2] = 0;
  clm_int[DEBUG + 2 + 1] = 0;                                                   /* (setf DEBUG NIL) */
                                                                                /* (dotimes (k fftsize) */
  K_1 = 0;                                                                      /* (setf K 0) */
  _clm_286 = ((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1])); /* (setf _clm_286 FFTSIZE) */
L_283:
  _clm_287 = (_clm_286 > K_1);                                                  /* (> _clm_286 K) */
  if (_clm_287) goto L_284;
  goto L_285;
L_284:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_291 + 0] = 2;
  clm_double[_clm_291_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_291 + 0] = 1;
  clm_int[_clm_291 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_291 + 0] = clm_int[iblock];
      clm_int[_clm_291 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_291_r + 0] = clm_double[rblock];
  }}}

                                                                                /* (case fftsize */
  goto L_294;
L_297:
  clm_int[_clm_296 + 0] = clm_int[FWI2048 + 0];
  clm_int[_clm_296 + 0 + 1] = clm_int[FWI2048 + 0 + 1];
  clm_double[_clm_296_r + 0] = clm_double[FWI2048_r + 0];                       /* (setf _clm_296 FWI2048) */
  goto L_295;
L_298:
  clm_int[_clm_296 + 0] = clm_int[FWI1024 + 0];
  clm_int[_clm_296 + 0 + 1] = clm_int[FWI1024 + 0 + 1];
  clm_double[_clm_296_r + 0] = clm_double[FWI1024_r + 0];                       /* (setf _clm_296 FWI1024) */
  goto L_295;
L_299:
  clm_int[_clm_296 + 0] = clm_int[FWI4096 + 0];
  clm_int[_clm_296 + 0 + 1] = clm_int[FWI4096 + 0 + 1];
  clm_double[_clm_296_r + 0] = clm_double[FWI4096_r + 0];                       /* (setf _clm_296 FWI4096) */
  goto L_295;
L_294:
  switch ((int)((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1]))){
    case 2048: goto L_297; break;
    case 1024: goto L_298; break;
    case 4096: goto L_299; break;
    }
  clm_int[_clm_296 + 0] = 0;
  clm_int[_clm_296 + 0 + 1] = 0;                                                /* (setf _clm_296 NIL) */
L_295:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[_clm_296 + 0 + 1]))
    {
    case 36: clm_int[_clm_292 + 0] = 2;
  clm_double[_clm_292_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[_clm_296 + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_292 + 0] = 1;
  clm_int[_clm_292 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[_clm_296 + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[_clm_296 + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[_clm_296 + 0 + 1]) + lci;
      clm_int[_clm_292 + 0] = clm_int[iblock];
      clm_int[_clm_292 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_292_r + 0] = clm_double[rblock];
  }}}

                                                                                /* (* _clm_291 _clm_292) */
  if ((clm_int[_clm_291 + 0] == 1) && (clm_int[_clm_292 + 0] == 1))
    {clm_int[_clm_290 + 0] = 1;
  clm_int[_clm_290 + 0 + 1] = ((clm_int[_clm_291 + 0 + 1]) * (clm_int[_clm_292 + 0 + 1]));}
  else {clm_int[_clm_290 + 0] = 2;
  clm_double[_clm_290_r+0] = ((((clm_int[_clm_291] == 2) ? clm_double[_clm_291_r] : (double)(clm_int[_clm_291 + 1]))) * (((clm_int[_clm_292] == 2) ? clm_double[_clm_292_r] : (double)(clm_int[_clm_292 + 1]))));}
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci] = ((clm_int[_clm_290] == 2) ? clm_double[_clm_290_r] : (double)(clm_int[_clm_290 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci] = ((clm_int[_clm_290] == 2) ? clm_double[_clm_290_r] : (double)(clm_int[_clm_290 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_290 + 0];
      clm_int[iblock + 1] = clm_int[_clm_290 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_290_r+0];
  }}}

  K_1 += 1;                                                                     /* (incf K 1) */
  goto L_283;
L_285:
  mus_fft((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1])), (double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1])), clm_int[FFTSIZE + 0 + 1], 1); /* (dotimes (k fftsize) */
  K_1 = 0;                                                                      /* (setf K 0) */
  _clm_306 = ((clm_int[FFTSIZE] == 2) ? clm_double[FFTSIZE_r] : (double)(clm_int[FFTSIZE + 1])); /* (setf _clm_306 FFTSIZE) */
L_303:
  _clm_307 = (_clm_306 > K_1);                                                  /* (> _clm_306 K) */
  if (_clm_307) goto L_304;
  goto L_305;
L_304:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_310 + 0] = 2;
  clm_double[_clm_310_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_310 + 0] = 1;
  clm_int[_clm_310 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_310 + 0] = clm_int[iblock];
      clm_int[_clm_310 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_310_r + 0] = clm_double[rblock];
  }}}

  clm_int[R + 0] = clm_int[_clm_310 + 0];
  clm_int[R + 0 + 1] = clm_int[_clm_310 + 0 + 1];
  clm_double[R_r + 0] = clm_double[_clm_310_r + 0];                             /* (setf R _clm_310) */
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDI + 0 + 1]))
    {
    case 36: clm_int[_clm_311 + 0] = 2;
  clm_double[_clm_311_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_311 + 0] = 1;
  clm_int[_clm_311 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDI + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDI + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1]) + lci;
      clm_int[_clm_311 + 0] = clm_int[iblock];
      clm_int[_clm_311 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_311_r + 0] = clm_double[rblock];
  }}}

  I_1 = ((clm_int[_clm_311] == 2) ? clm_double[_clm_311_r] : (double)(clm_int[_clm_311 + 1])); /* (setf I _clm_311) */
                                                                                /* (* r r) */
  if ((clm_int[R + 0] == 1) && (clm_int[R + 0] == 1))
    {clm_int[_clm_313 + 0] = 1;
  clm_int[_clm_313 + 0 + 1] = ((clm_int[R + 0 + 1]) * (clm_int[R + 0 + 1]));}
  else {clm_int[_clm_313 + 0] = 2;
  clm_double[_clm_313_r+0] = ((((clm_int[R] == 2) ? clm_double[R_r] : (double)(clm_int[R + 1]))) * (((clm_int[R] == 2) ? clm_double[R_r] : (double)(clm_int[R + 1]))));}
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci] = ((clm_int[_clm_313] == 2) ? clm_double[_clm_313_r] : (double)(clm_int[_clm_313 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci] = ((clm_int[_clm_313] == 2) ? clm_double[_clm_313_r] : (double)(clm_int[_clm_313 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_313 + 0];
      clm_int[iblock + 1] = clm_int[_clm_313 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_313_r+0];
  }}}

                                                                                /* (* -1 i) */
  clm_int[_clm_316 + 0] = 1;
  clm_int[_clm_316 + 0 + 1] = ((-1) * (I_1));
                                                                                /* (* i _clm_316) */
  if ((1) && (clm_int[_clm_316 + 0] == 1))
    {clm_int[_clm_315 + 0] = 1;
  clm_int[_clm_315 + 0 + 1] = ((I_1) * (clm_int[_clm_316 + 0 + 1]));}
  else {clm_int[_clm_315 + 0] = 2;
  clm_double[_clm_315_r+0] = ((I_1) * (((clm_int[_clm_316] == 2) ? clm_double[_clm_316_r] : (double)(clm_int[_clm_316 + 1]))));}
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDI + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1]) + lci] = ((clm_int[_clm_315] == 2) ? clm_double[_clm_315_r] : (double)(clm_int[_clm_315 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FDI + 0 + 1]) + lci] = ((clm_int[_clm_315] == 2) ? clm_double[_clm_315_r] : (double)(clm_int[_clm_315 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDI + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_315 + 0];
      clm_int[iblock + 1] = clm_int[_clm_315 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_315_r+0];
  }}}

  K_1 += 1;                                                                     /* (incf K 1) */
  goto L_303;
L_305:
  mus_fft((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1])), (double *)(clm_double + CLM_ARR_RBLOCK(clm_int[FDI + 0 + 1])), clm_int[FFTSIZE + 0 + 1], -1); /* (progn */
  memset((void *)((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]))), 0, (CLM_ARR_SIZE(clm_int[ZCROSSES + 0 + 1])) * sizeof(mus_float_t));
  clm_int[ZCROSSCT + 0] = 1;
  clm_int[ZCROSSCT + 0 + 1] = 0;                                                /* (setf ZCROSSCT 0) */
                                                                                /* (dotimes (k fft2) */
  K_1 = 0;                                                                      /* (setf K 0) */
  _clm_326 = FFT2;                                                              /* (setf _clm_326 FFT2) */
L_323:
  _clm_327 = (_clm_326 > K_1);                                                  /* (> _clm_326 K) */
  if (_clm_327) goto L_324;
  goto L_325;
L_324:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_330 + 0] = 2;
  clm_double[_clm_330_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_330 + 0] = 1;
  clm_int[_clm_330 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_330 + 0] = clm_int[iblock];
      clm_int[_clm_330 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_330_r + 0] = clm_double[rblock];
  }}}

  clm_int[THIS + 0] = clm_int[_clm_330 + 0];
  clm_int[THIS + 0 + 1] = clm_int[_clm_330 + 0 + 1];
  clm_double[THIS_r + 0] = clm_double[_clm_330_r + 0];                          /* (setf THIS _clm_330) */
  _clm_332 = K_1 + 1;
  {int lci; lci = _clm_332;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_331 + 0] = 2;
  clm_double[_clm_331_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_331 + 0] = 1;
  clm_int[_clm_331 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_331 + 0] = clm_int[iblock];
      clm_int[_clm_331 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_331_r + 0] = clm_double[rblock];
  }}}

  clm_int[NEXT + 0] = clm_int[_clm_331 + 0];
  clm_int[NEXT + 0 + 1] = clm_int[_clm_331 + 0 + 1];
  clm_double[NEXT_r + 0] = clm_double[_clm_331_r + 0];                          /* (setf NEXT _clm_331) */
                                                                                /* (if (or (= 0 this) (and (plusp this) (minusp next))
     (and (minusp this) (plusp next))) */
  _clm_341 = (0 == ((clm_int[THIS] == 2) ? clm_double[THIS_r] : (double)(clm_int[THIS + 1]))); /* (== 0 THIS) */
  G338 = _clm_341;                                                              /* (setf G338 _clm_341) */
                                                                                /* (if g338 */
  if ((!G338)) goto L_343;
  clm_int[_clm_342 + 0] = 0;
  clm_int[_clm_342 + 0 + 1] = G338;                                             /* (setf _clm_342 G338) */
  goto L_344;
L_343:
                                                                                /* (if (plusp this) */
    if (clm_int[THIS + 0]==1) _clm_350 = (clm_int[THIS + 0 + 1] > 0); else _clm_350 = (clm_double[THIS_r+0] > 0.0);
;                                                                               /* (plusp THIS) */
  if ((!_clm_350)) goto L_348;
    if (clm_int[NEXT + 0]==1) _clm_351 = (clm_int[NEXT + 0 + 1] < 0); else _clm_351 = (clm_double[NEXT_r+0] < 0.0);
;                                                                               /* (minusp NEXT) */
  clm_int[_clm_347 + 0] = 0;
  clm_int[_clm_347 + 0 + 1] = _clm_351;                                         /* (setf _clm_347 _clm_351) */
  goto L_349;
L_348:
  clm_int[_clm_347 + 0] = 0;
  clm_int[_clm_347 + 0 + 1] = 0;                                                /* (setf _clm_347 NIL) */
L_349:
  clm_int[G339 + 0] = clm_int[_clm_347 + 0];
  clm_int[G339 + 0 + 1] = clm_int[_clm_347 + 0 + 1];
  clm_double[G339_r + 0] = clm_double[_clm_347_r + 0];                          /* (setf G339 _clm_347) */
                                                                                /* (if g339 */
  if (((clm_int[G339] == 0) && (clm_int[G339 + 1] == 0))) goto L_353;
  clm_int[_clm_352 + 0] = clm_int[G339 + 0];
  clm_int[_clm_352 + 0 + 1] = clm_int[G339 + 0 + 1];
  clm_double[_clm_352_r + 0] = clm_double[G339_r + 0];                          /* (setf _clm_352 G339) */
  goto L_354;
L_353:
                                                                                /* (if (minusp this) */
    if (clm_int[THIS + 0]==1) _clm_359 = (clm_int[THIS + 0 + 1] < 0); else _clm_359 = (clm_double[THIS_r+0] < 0.0);
;                                                                               /* (minusp THIS) */
  if ((!_clm_359)) goto L_357;
    if (clm_int[NEXT + 0]==1) _clm_360 = (clm_int[NEXT + 0 + 1] > 0); else _clm_360 = (clm_double[NEXT_r+0] > 0.0);
;                                                                               /* (plusp NEXT) */
  clm_int[_clm_356 + 0] = 0;
  clm_int[_clm_356 + 0 + 1] = _clm_360;                                         /* (setf _clm_356 _clm_360) */
  goto L_358;
L_357:
  clm_int[_clm_356 + 0] = 0;
  clm_int[_clm_356 + 0 + 1] = 0;                                                /* (setf _clm_356 NIL) */
L_358:
  clm_int[_clm_352 + 0] = clm_int[_clm_356 + 0];
  clm_int[_clm_352 + 0 + 1] = clm_int[_clm_356 + 0 + 1];
  clm_double[_clm_352_r + 0] = clm_double[_clm_356_r + 0];                      /* (setf _clm_352 _clm_356) */
L_354:
  clm_int[_clm_345 + 0] = clm_int[_clm_352 + 0];
  clm_int[_clm_345 + 0 + 1] = clm_int[_clm_352 + 0 + 1];
  clm_double[_clm_345_r + 0] = clm_double[_clm_352_r + 0];                      /* (setf _clm_345 _clm_352) */
  clm_int[_clm_342 + 0] = clm_int[_clm_345 + 0];
  clm_int[_clm_342 + 0 + 1] = clm_int[_clm_345 + 0 + 1];
  clm_double[_clm_342_r + 0] = clm_double[_clm_345_r + 0];                      /* (setf _clm_342 _clm_345) */
L_344:
  _clm_340 = ((clm_int[_clm_342] == 2) ? clm_double[_clm_342_r] : (double)(clm_int[_clm_342 + 1])); /* (setf _clm_340 _clm_342) */
  if ((!_clm_340)) goto L_335;
                                                                                /* (progn */
  {int lci; lci = clm_int[ZCROSSCT + 0 + 1];
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = K_1; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = K_1; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[iblock] = 1; clm_int[iblock+1] = K_1;
  }}}

  clm_int[ZCROSSCT + 0] = 1;
  clm_int[ZCROSSCT + 0 + 1] += 1;                                               /* (incf ZCROSSCT 1) */
  goto L_336;
L_335:
L_336:
  K_1 += 1;                                                                     /* (incf K 1) */
  goto L_323;
L_325:
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_365;
                                                                                /* (clm-print "~D total z-crossings~%"  ZCROSSCT) */
  mus_error(0, "%" PRId64"  total z-crossings\n",
        (mus_long_t)((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1])));
  goto L_366;
L_365:
L_366:
  K_1 = 0;                                                                      /* (setf K 0) */
                                                                                /* (tagbody */
NEXT_LOOP_L_60:
                                                                                /* (if (>= k (- zcrossct 1)) */
                                                                                /* (- zcrossct 1) */
  if ((clm_int[ZCROSSCT + 0] == 1) && (1))
    {clm_int[_clm_379 + 0] = 1;
  clm_int[_clm_379 + 0 + 1] = ((clm_int[ZCROSSCT + 0 + 1]) - (1));}
  else {clm_int[_clm_379 + 0] = 2;
  clm_double[_clm_379_r+0] = ((((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1]))) - (1));}
  _clm_378 = (K_1 >= ((clm_int[_clm_379] == 2) ? clm_double[_clm_379_r] : (double)(clm_int[_clm_379 + 1]))); /* (>= K _clm_379) */
  if ((!_clm_378)) goto L_376;
                                                                                /* (go end-loop */
  goto END_LOOP_L_60;
  goto L_377;
L_376:
L_377:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_int[_clm_382 + 0] = 2;
  clm_double[_clm_382_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_382 + 0] = 1;
  clm_int[_clm_382 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[_clm_382 + 0] = clm_int[iblock];
      clm_int[_clm_382 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_382_r + 0] = clm_double[rblock];
  }}}

  clm_int[THISX + 0] = clm_int[_clm_382 + 0];
  clm_int[THISX + 0 + 1] = clm_int[_clm_382 + 0 + 1];
  clm_double[THISX_r + 0] = clm_double[_clm_382_r + 0];                         /* (setf THISX _clm_382) */
                                                                                /* (+ 1 k) */
  _clm_384 = ((1) + (K_1));
  {int lci; lci = _clm_384;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_int[_clm_383 + 0] = 2;
  clm_double[_clm_383_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_383 + 0] = 1;
  clm_int[_clm_383 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[_clm_383 + 0] = clm_int[iblock];
      clm_int[_clm_383 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_383_r + 0] = clm_double[rblock];
  }}}

  clm_int[NEXTX + 0] = clm_int[_clm_383 + 0];
  clm_int[NEXTX + 0 + 1] = clm_int[_clm_383 + 0 + 1];
  clm_double[NEXTX_r + 0] = clm_double[_clm_383_r + 0];                         /* (setf NEXTX _clm_383) */
                                                                                /* (+ nextx thisx) */
  if ((clm_int[NEXTX + 0] == 1) && (clm_int[THISX + 0] == 1))
    {clm_int[_clm_387 + 0] = 1;
  clm_int[_clm_387 + 0 + 1] = ((clm_int[NEXTX + 0 + 1]) + (clm_int[THISX + 0 + 1]));}
  else {clm_int[_clm_387 + 0] = 2;
  clm_double[_clm_387_r+0] = ((((clm_int[NEXTX] == 2) ? clm_double[NEXTX_r] : (double)(clm_int[NEXTX + 1]))) + (((clm_int[THISX] == 2) ? clm_double[THISX_r] : (double)(clm_int[THISX + 1]))));}
  _clm_386 = ((double)((clm_int[_clm_387] == 2) ? clm_double[_clm_387_r] : (double)(clm_int[_clm_387 + 1])) / (double)((2)));
                                                                                /* (/ _clm_387 2) */
  _clm_385 = (mus_long_t)floor((double)((_clm_386) + .5));                      /* (round _clm_386) */
  if ( (((_clm_385) - (_clm_386)) == .5) && (((mus_long_t)(_clm_385)) & 1) ) _clm_385 -= 1;;
  TWEENX = _clm_385;                                                            /* (setf TWEENX _clm_385) */
  {int lci; lci = TWEENX;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_388 + 0] = 2;
  clm_double[_clm_388_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_388 + 0] = 1;
  clm_int[_clm_388 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_388 + 0] = clm_int[iblock];
      clm_int[_clm_388 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_388_r + 0] = clm_double[rblock];
  }}}

  clm_int[TWEENY + 0] = clm_int[_clm_388 + 0];
  clm_int[TWEENY + 0 + 1] = clm_int[_clm_388 + 0 + 1];
  clm_double[TWEENY_r + 0] = clm_double[_clm_388_r + 0];                        /* (setf TWEENY _clm_388) */
                                                                                /* (if (minusp tweeny) */
    if (clm_int[TWEENY + 0]==1) _clm_392 = (clm_int[TWEENY + 0 + 1] < 0); else _clm_392 = (clm_double[TWEENY_r+0] < 0.0);
;                                                                               /* (minusp TWEENY) */
  if ((!_clm_392)) goto L_390;
                                                                                /* (progn */
  J_1 = K_1;                                                                    /* (setf J K) */
  LOOP_LIMIT_395 = ((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1])); /* (setf LOOP-LIMIT-395 ZCROSSCT) */
                                                                                /* (tagbody */
NEXT_LOOP_L_61:
                                                                                /* (if (>= j loop-limit-395) */
  _clm_405 = (J_1 >= LOOP_LIMIT_395);                                           /* (>= J LOOP-LIMIT-395) */
  if ((!_clm_405)) goto L_403;
                                                                                /* (go end-loop */
  goto END_LOOP_L_61;
  goto L_404;
L_403:
L_404:
  _clm_409 = J_1 + 1.0;
  {int lci; lci = _clm_409;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_int[_clm_408 + 0] = 2;
  clm_double[_clm_408_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_408 + 0] = 1;
  clm_int[_clm_408 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[_clm_408 + 0] = clm_int[iblock];
      clm_int[_clm_408 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_408_r + 0] = clm_double[rblock];
  }}}

  {int lci; lci = J_1;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = ((clm_int[_clm_408] == 2) ? clm_double[_clm_408_r] : (double)(clm_int[_clm_408 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = ((clm_int[_clm_408] == 2) ? clm_double[_clm_408_r] : (double)(clm_int[_clm_408 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_408 + 0];
      clm_int[iblock + 1] = clm_int[_clm_408 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_408_r+0];
  }}}

  _clm_412 = J_1 + 1.0;
  J_1 = _clm_412;                                                               /* (setf J _clm_412) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_61;
END_LOOP_L_61:
                                                                                /* (block nil */
  clm_int[ZCROSSCT + 0] = 1;
  clm_int[ZCROSSCT + 0 + 1] -= 1;                                               /* (decf ZCROSSCT 1) */
  goto L_391;
L_390:
  K_1 += 2;                                                                     /* (incf K 2) */
L_391:
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_60;
END_LOOP_L_60:
                                                                                /* (block nil */
                                                                                /* (if (oddp zcrossct) */
  _clm_421 = (clm_int[ZCROSSCT + 0 + 1] % 2);                                   /* (oddp ZCROSSCT) */
  if ((!_clm_421)) goto L_419;
                                                                                /* (progn */
  clm_int[ZCROSSCT + 0] = 1;
  clm_int[ZCROSSCT + 0 + 1] -= 1;                                               /* (decf ZCROSSCT 1) */
  {int lci; lci = clm_int[ZCROSSCT + 0 + 1];
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = 0; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci] = 0; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
    clm_int[iblock] = 1; clm_int[iblock + 1] = 0;
  }}}

  goto L_420;
L_419:
L_420:
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_426;
                                                                                /* (clm-print "~D peak bracketing z-crossings~%"  ZCROSSCT) */
  mus_error(0, "%" PRId64"  peak bracketing z-crossings\n",
        (mus_long_t)((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1])));
  goto L_427;
L_426:
L_427:
                                                                                /* (if (and lowfq-warn-flag (= 0 zcrossct)) */
                                                                                /* (if lowfq-warn-flag */
  if (((clm_int[LOWFQ_WARN_FLAG] == 0) && (clm_int[LOWFQ_WARN_FLAG + 1] == 0))) goto L_435;
  _clm_437 = (0 == ((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1]))); /* (== 0 ZCROSSCT) */
  _clm_434 = _clm_437;                                                          /* (setf _clm_434 _clm_437) */
  goto L_436;
L_435:
  _clm_434 = 0;                                                                 /* (setf _clm_434 NIL) */
L_436:
  if ((!_clm_434)) goto L_431;
                                                                                /* (progn */
                                                                                /* (clm-print "~%Warning: autoc found 0 peaks in at least 1 autocorrelation. db-floor may be too low.~%" ) */
  mus_error(0, "\nWarning: autoc found 0 peaks in at least 1 autocorrelation. db-floor may be too low.\n");
  clm_int[LOWFQ_WARN_FLAG + 0] = 0;
  clm_int[LOWFQ_WARN_FLAG + 0 + 1] = 0;                                         /* (setf LOWFQ-WARN-FLAG NIL) */
  goto L_432;
L_431:
L_432:
                                                                                /* (progn */
  memset((void *)((double *)(clm_double + CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]))), 0, (CLM_ARR_SIZE(clm_int[PEAKS + 0 + 1])) * sizeof(mus_float_t));
  clm_int[PEAKSCT + 0] = 1;
  clm_int[PEAKSCT + 0 + 1] = 0;                                                 /* (setf PEAKSCT 0) */
  K_1 = 0;                                                                      /* (setf K 0) */
  LOOP_LIMIT_446 = ((clm_int[ZCROSSCT] == 2) ? clm_double[ZCROSSCT_r] : (double)(clm_int[ZCROSSCT + 1])); /* (setf LOOP-LIMIT-446 ZCROSSCT) */
                                                                                /* (tagbody */
NEXT_LOOP_L_62:
                                                                                /* (if (>= k loop-limit-446) */
  _clm_456 = (K_1 >= LOOP_LIMIT_446);                                           /* (>= K LOOP-LIMIT-446) */
  if ((!_clm_456)) goto L_454;
                                                                                /* (go end-loop */
  goto END_LOOP_L_62;
  goto L_455;
L_454:
L_455:
  {int lci; lci = K_1;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_int[_clm_460 + 0] = 2;
  clm_double[_clm_460_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_460 + 0] = 1;
  clm_int[_clm_460 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[_clm_460 + 0] = clm_int[iblock];
      clm_int[_clm_460 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_460_r + 0] = clm_double[rblock];
  }}}

  _clm_459 = (mus_long_t)floor((double)(((clm_int[_clm_460] == 2) ? clm_double[_clm_460_r] : (double)(clm_int[_clm_460 + 1])))); /* (floor _clm_460) */
  STARTX = _clm_459;                                                            /* (setf STARTX _clm_459) */
  _clm_463 = K_1 + 1;
  {int lci; lci = _clm_463;
  switch (CLM_ARR_TYPE(clm_int[ZCROSSES + 0 + 1]))
    {
    case 36: clm_int[_clm_462 + 0] = 2;
  clm_double[_clm_462_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_462 + 0] = 1;
  clm_int[_clm_462 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[ZCROSSES + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[ZCROSSES + 0 + 1]) + lci;
      clm_int[_clm_462 + 0] = clm_int[iblock];
      clm_int[_clm_462 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_462_r + 0] = clm_double[rblock];
  }}}

  _clm_461 = (mus_long_t)floor((double)(((clm_int[_clm_462] == 2) ? clm_double[_clm_462_r] : (double)(clm_int[_clm_462 + 1])))); /* (floor _clm_462) */
  ENDX = _clm_461;                                                              /* (setf ENDX _clm_461) */
  clm_int[MAXY + 0] = 1;
  clm_int[MAXY + 0 + 1] = 0;                                                    /* (setf MAXY 0) */
  X = STARTX;                                                                   /* (setf X STARTX) */
  LOOP_LIMIT_465 = ENDX;                                                        /* (setf LOOP-LIMIT-465 ENDX) */
                                                                                /* (tagbody */
NEXT_LOOP_L_63:
                                                                                /* (if (> x loop-limit-465) */
  _clm_475 = (X > LOOP_LIMIT_465);                                              /* (> X LOOP-LIMIT-465) */
  if ((!_clm_475)) goto L_473;
                                                                                /* (go end-loop */
  goto END_LOOP_L_63;
  goto L_474;
L_473:
L_474:
  {int lci; lci = X;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_478 + 0] = 2;
  clm_double[_clm_478_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_478 + 0] = 1;
  clm_int[_clm_478 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_478 + 0] = clm_int[iblock];
      clm_int[_clm_478 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_478_r + 0] = clm_double[rblock];
  }}}

  clm_int[THISY + 0] = clm_int[_clm_478 + 0];
  clm_int[THISY + 0 + 1] = clm_int[_clm_478 + 0 + 1];
  clm_double[THISY_r + 0] = clm_double[_clm_478_r + 0];                         /* (setf THISY _clm_478) */
                                                                                /* (if (> thisy maxy) */
  _clm_483 = (((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) > ((clm_int[MAXY] == 2) ? clm_double[MAXY_r] : (double)(clm_int[MAXY + 1]))); /* (> THISY MAXY) */
  if ((!_clm_483)) goto L_481;
                                                                                /* (progn */
  clm_int[MAXY + 0] = clm_int[THISY + 0];
  clm_int[MAXY + 0 + 1] = clm_int[THISY + 0 + 1];
  clm_double[MAXY_r + 0] = clm_double[THISY_r + 0];                             /* (setf MAXY THISY) */
  clm_int[MAXX + 0] = 1;
  clm_int[MAXX + 0 + 1] = X;                                                    /* (setf MAXX X) */
  goto L_482;
L_481:
L_482:
  _clm_489 = X + 1;
  X = _clm_489;                                                                 /* (setf X _clm_489) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_63;
END_LOOP_L_63:
                                                                                /* (block nil */
  {int lci; lci = clm_int[PEAKSCT + 0 + 1];
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci] = ((clm_int[MAXX] == 2) ? clm_double[MAXX_r] : (double)(clm_int[MAXX + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci] = ((clm_int[MAXX] == 2) ? clm_double[MAXX_r] : (double)(clm_int[MAXX + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[MAXX + 0];
      clm_int[iblock + 1] = clm_int[MAXX + 0 + 1];
      clm_double[rblock] = clm_double[MAXX_r+0];
  }}}

  clm_int[PEAKSCT + 0] = 1;
  clm_int[PEAKSCT + 0 + 1] += 1;                                                /* (incf PEAKSCT 1) */
                                                                                /* (+ k 2) */
  _clm_495 = ((K_1) + (2));
  K_1 = _clm_495;                                                               /* (setf K _clm_495) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_62;
END_LOOP_L_62:
                                                                                /* (block nil */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_498;
                                                                                /* (clm-print "~D total peaks~%"  PEAKSCT) */
  mus_error(0, "%" PRId64"  total peaks\n",
        (mus_long_t)((clm_int[PEAKSCT] == 2) ? clm_double[PEAKSCT_r] : (double)(clm_int[PEAKSCT + 1])));
  goto L_499;
L_498:
L_499:
  MAXPEAKINDEX = 0;                                                             /* (setf MAXPEAKINDEX 0) */
  clm_int[MAXPEAKY + 0] = 1;
  clm_int[MAXPEAKY + 0 + 1] = 0;                                                /* (setf MAXPEAKY 0) */
  {int lci; lci = 0;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_503 + 0] = 2;
  clm_double[_clm_503_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_503 + 0] = 1;
  clm_int[_clm_503 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_503 + 0] = clm_int[iblock];
      clm_int[_clm_503 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_503_r + 0] = clm_double[rblock];
  }}}

  clm_int[LEFTY + 0] = clm_int[_clm_503 + 0];
  clm_int[LEFTY + 0 + 1] = clm_int[_clm_503 + 0 + 1];
  clm_double[LEFTY_r + 0] = clm_double[_clm_503_r + 0];                         /* (setf LEFTY _clm_503) */
  I_1 = 0;                                                                      /* (setf I 0) */
  LOOP_LIMIT_505 = ((clm_int[PEAKSCT] == 2) ? clm_double[PEAKSCT_r] : (double)(clm_int[PEAKSCT + 1])); /* (setf LOOP-LIMIT-505 PEAKSCT) */
                                                                                /* (tagbody */
NEXT_LOOP_L_64:
                                                                                /* (if (>= i loop-limit-505) */
  _clm_515 = (I_1 >= LOOP_LIMIT_505);                                           /* (>= I LOOP-LIMIT-505) */
  if ((!_clm_515)) goto L_513;
                                                                                /* (go end-loop */
  goto END_LOOP_L_64;
  goto L_514;
L_513:
L_514:
  {int lci; lci = I_1;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_int[_clm_519 + 0] = 2;
  clm_double[_clm_519_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_519 + 0] = 1;
  clm_int[_clm_519 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[_clm_519 + 0] = clm_int[iblock];
      clm_int[_clm_519 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_519_r + 0] = clm_double[rblock];
  }}}

  _clm_518 = (mus_long_t)floor((double)(((clm_int[_clm_519] == 2) ? clm_double[_clm_519_r] : (double)(clm_int[_clm_519 + 1])))); /* (floor _clm_519) */
  PEAKX = _clm_518;                                                             /* (setf PEAKX _clm_518) */
  {int lci; lci = PEAKX;
  switch (CLM_ARR_TYPE(clm_int[FDR + 0 + 1]))
    {
    case 36: clm_int[_clm_520 + 0] = 2;
  clm_double[_clm_520_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_520 + 0] = 1;
  clm_int[_clm_520 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FDR + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FDR + 0 + 1]) + lci;
      clm_int[_clm_520 + 0] = clm_int[iblock];
      clm_int[_clm_520 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_520_r + 0] = clm_double[rblock];
  }}}

  clm_int[PEAKY + 0] = clm_int[_clm_520 + 0];
  clm_int[PEAKY + 0 + 1] = clm_int[_clm_520 + 0 + 1];
  clm_double[PEAKY_r + 0] = clm_double[_clm_520_r + 0];                         /* (setf PEAKY _clm_520) */
                                                                                /* (if (> peaky maxpeaky) */
  _clm_524 = (((clm_int[PEAKY] == 2) ? clm_double[PEAKY_r] : (double)(clm_int[PEAKY + 1])) > ((clm_int[MAXPEAKY] == 2) ? clm_double[MAXPEAKY_r] : (double)(clm_int[MAXPEAKY + 1]))); /* (> PEAKY MAXPEAKY) */
  if ((!_clm_524)) goto L_522;
  clm_int[MAXPEAKY + 0] = clm_int[PEAKY + 0];
  clm_int[MAXPEAKY + 0 + 1] = clm_int[PEAKY + 0 + 1];
  clm_double[MAXPEAKY_r + 0] = clm_double[PEAKY_r + 0];                         /* (setf MAXPEAKY PEAKY) */
  MAXPEAKINDEX = I_1;                                                           /* (setf MAXPEAKINDEX I) */
  goto L_523;
L_522:
L_523:
  _clm_528 = I_1 + 1;
  I_1 = _clm_528;                                                               /* (setf I _clm_528) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_64;
END_LOOP_L_64:
                                                                                /* (block nil */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_532;
  {int lci; lci = MAXPEAKINDEX;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_int[_clm_536 + 0] = 2;
  clm_double[_clm_536_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_536 + 0] = 1;
  clm_int[_clm_536 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[_clm_536 + 0] = clm_int[iblock];
      clm_int[_clm_536 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_536_r + 0] = clm_double[rblock];
  }}}

  _clm_535 = (mus_long_t)floor((double)(((clm_int[_clm_536] == 2) ? clm_double[_clm_536_r] : (double)(clm_int[_clm_536 + 1])))); /* (floor _clm_536) */
                                                                                /* (clm-print "Max peak index = ~D, x = ~D, y = ~F.~%"  MAXPEAKINDEX _clm_535 MAXPEAKY) */
  mus_error(0, "Max peak index = %" PRId64" , x = %" PRId64" , y = %f.\n",
        (mus_long_t)MAXPEAKINDEX,
        (mus_long_t)_clm_535,
        (double)((clm_int[MAXPEAKY] == 2) ? clm_double[MAXPEAKY_r] : (double)(clm_int[MAXPEAKY + 1])));
  goto L_533;
L_532:
L_533:
                                                                                /* (if (> maxpeakindex 0) */
  _clm_541 = (MAXPEAKINDEX > 0);                                                /* (> MAXPEAKINDEX 0) */
  if ((!_clm_541)) goto L_539;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_545;
                                                                                /* (clm-print "Discarding earlier peaks.~%" ) */
  mus_error(0, "Discarding earlier peaks.\n");
  goto L_546;
L_545:
L_546:
  J_1 = MAXPEAKINDEX;                                                           /* (setf J MAXPEAKINDEX) */
  LOOP_LIMIT_549 = ((clm_int[PEAKSCT] == 2) ? clm_double[PEAKSCT_r] : (double)(clm_int[PEAKSCT + 1])); /* (setf LOOP-LIMIT-549 PEAKSCT) */
                                                                                /* (tagbody */
NEXT_LOOP_L_65:
                                                                                /* (if (>= j loop-limit-549) */
  _clm_559 = (J_1 >= LOOP_LIMIT_549);                                           /* (>= J LOOP-LIMIT-549) */
  if ((!_clm_559)) goto L_557;
                                                                                /* (go end-loop */
  goto END_LOOP_L_65;
  goto L_558;
L_557:
L_558:
  {int lci; lci = J_1;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_int[_clm_562 + 0] = 2;
  clm_double[_clm_562_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_562 + 0] = 1;
  clm_int[_clm_562 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[_clm_562 + 0] = clm_int[iblock];
      clm_int[_clm_562 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_562_r + 0] = clm_double[rblock];
  }}}

                                                                                /* (- j maxpeakindex) */
  _clm_563 = ((J_1) - (MAXPEAKINDEX));
  {int lci; lci = _clm_563;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci] = ((clm_int[_clm_562] == 2) ? clm_double[_clm_562_r] : (double)(clm_int[_clm_562 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci] = ((clm_int[_clm_562] == 2) ? clm_double[_clm_562_r] : (double)(clm_int[_clm_562 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_562 + 0];
      clm_int[iblock + 1] = clm_int[_clm_562 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_562_r+0];
  }}}

  _clm_566 = J_1 + 1.0;
  J_1 = _clm_566;                                                               /* (setf J _clm_566) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_65;
END_LOOP_L_65:
                                                                                /* (block nil */
  clm_int[PEAKSCT + 0] = 1;
  clm_int[PEAKSCT + 0 + 1] -= MAXPEAKINDEX;                                     /* (decf PEAKSCT MAXPEAKINDEX) */
  goto L_540;
L_539:
L_540:
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_570;
  {int lci; lci = 0;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_int[_clm_573 + 0] = 2;
  clm_double[_clm_573_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_573 + 0] = 1;
  clm_int[_clm_573 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[_clm_573 + 0] = clm_int[iblock];
      clm_int[_clm_573 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_573_r + 0] = clm_double[rblock];
  }}}

                                                                                /* (clm-print "~F max peak~%"  _clm_573) */
  mus_error(0, "%f max peak\n",
        (double)((clm_int[_clm_573] == 2) ? clm_double[_clm_573_r] : (double)(clm_int[_clm_573 + 1])));
  goto L_571;
L_570:
L_571:
  {int lci; lci = 0;
  switch (CLM_ARR_TYPE(clm_int[PEAKS + 0 + 1]))
    {
    case 36: clm_int[_clm_575 + 0] = 2;
  clm_double[_clm_575_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_575 + 0] = 1;
  clm_int[_clm_575 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[PEAKS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[PEAKS + 0 + 1]) + lci;
      clm_int[_clm_575 + 0] = clm_int[iblock];
      clm_int[_clm_575 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_575_r + 0] = clm_double[rblock];
  }}}

  clm_int[PEAK + 0] = clm_int[_clm_575 + 0];
  clm_int[PEAK + 0 + 1] = clm_int[_clm_575 + 0 + 1];
  clm_double[PEAK_r + 0] = clm_double[_clm_575_r + 0];                          /* (setf PEAK _clm_575) */
  goto L_252;
L_251:
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_578;
                                                                                /* (clm-print "Window discarded due to low amplitude~%" ) */
  mus_error(0, "Window discarded due to low amplitude\n");
  goto L_579;
L_578:
L_579:
  clm_int[WINFREQ + 0] = 1;
  clm_int[WINFREQ + 0 + 1] = 0;                                                 /* (setf WINFREQ 0) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_57;
L_252:
                                                                                /* (if (= peak 0) */
  _clm_588 = (((clm_int[PEAK] == 2) ? clm_double[PEAK_r] : (double)(clm_int[PEAK + 1])) == 0); /* (== PEAK 0) */
  if ((!_clm_588)) goto L_586;
  clm_int[_clm_585 + 0] = 1;
  clm_int[_clm_585 + 0 + 1] = 0;                                                /* (setf _clm_585 0) */
  goto L_587;
L_586:
  _clm_589 = ((double)((clm_int[FSR] == 2) ? clm_double[FSR_r] : (double)(clm_int[FSR + 1])) / (double)((((clm_int[PEAK] == 2) ? clm_double[PEAK_r] : (double)(clm_int[PEAK + 1])))));
                                                                                /* (/ FSR peak) */
  clm_int[_clm_585 + 0] = 2;
  clm_double[_clm_585_r+0] = _clm_589;                                          /* (setf _clm_585 _clm_589) */
L_587:
  clm_int[WINFREQ + 0] = clm_int[_clm_585 + 0];
  clm_int[WINFREQ + 0 + 1] = clm_int[_clm_585 + 0 + 1];
  clm_double[WINFREQ_r + 0] = clm_double[_clm_585_r + 0];                       /* (setf WINFREQ _clm_585) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_592;
                                                                                /* (clm-print "~F frequency~%"  WINFREQ) */
  mus_error(0, "%f frequency\n",
        (double)((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])));
  goto L_593;
L_592:
L_593:
                                                                                /* (if closest */
  if (((clm_int[CLOSEST] == 0) && (clm_int[CLOSEST + 1] == 0))) goto L_596;
  _clm_600 = J - 1.0;
  {int lci; lci = _clm_600;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_599 + 0] = 2;
  clm_double[_clm_599_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_599 + 0] = 1;
  clm_int[_clm_599 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_599 + 0] = clm_int[iblock];
      clm_int[_clm_599 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_599_r + 0] = clm_double[rblock];
  }}}

  clm_int[LASTY + 0] = clm_int[_clm_599 + 0];
  clm_int[LASTY + 0 + 1] = clm_int[_clm_599 + 0 + 1];
  clm_double[LASTY_r + 0] = clm_double[_clm_599_r + 0];                         /* (setf LASTY _clm_599) */
                                                                                /* (if (< (ac-get-ratio lasty winfreq) (ac-get-ratio lasty closest)) */
                                                                                /* (progn */
                                                                                /* (if (or (zerop lasty) (zerop winfreq)) */
    if (clm_int[LASTY + 0]==1) _clm_613 = (clm_int[LASTY + 0 + 1] == 0); else _clm_613 = (clm_double[LASTY_r+0] == 0.0);
;                                                                               /* (zerop LASTY) */
  G611 = _clm_613;                                                              /* (setf G611 _clm_613) */
                                                                                /* (if g611 */
  if ((!G611)) goto L_615;
  clm_int[_clm_614 + 0] = 0;
  clm_int[_clm_614 + 0 + 1] = G611;                                             /* (setf _clm_614 G611) */
  goto L_616;
L_615:
    if (clm_int[WINFREQ + 0]==1) _clm_617 = (clm_int[WINFREQ + 0 + 1] == 0); else _clm_617 = (clm_double[WINFREQ_r+0] == 0.0);
;                                                                               /* (zerop WINFREQ) */
  clm_int[_clm_614 + 0] = 0;
  clm_int[_clm_614 + 0 + 1] = _clm_617;                                         /* (setf _clm_614 _clm_617) */
L_616:
  _clm_612 = ((clm_int[_clm_614] == 2) ? clm_double[_clm_614_r] : (double)(clm_int[_clm_614 + 1])); /* (setf _clm_612 _clm_614) */
  if ((!_clm_612)) goto L_608;
  clm_int[_clm_607 + 0] = 1;
  clm_int[_clm_607 + 0 + 1] = 0;                                                /* (setf _clm_607 0) */
  goto L_609;
L_608:
  _clm_619 = ((double)((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])) / (double)((((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])))));
                                                                                /* (/ WINFREQ lasty) */
  RATIO = _clm_619;                                                             /* (setf RATIO _clm_619) */
                                                                                /* (if (< ratio 1.0) */
  _clm_623 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_623)) goto L_621;
  _clm_625 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_625;                                                             /* (setf RATIO _clm_625) */
  clm_int[_clm_620 + 0] = 2;
  clm_double[_clm_620_r+0] = _clm_625;                                          /* (setf _clm_620 _clm_625) */
  goto L_622;
L_621:
  clm_int[_clm_620 + 0] = 2;
  clm_double[_clm_620_r+0] = RATIO;                                             /* (setf _clm_620 RATIO) */
L_622:
  clm_int[_clm_618 + 0] = clm_int[_clm_620 + 0];
  clm_int[_clm_618 + 0 + 1] = clm_int[_clm_620 + 0 + 1];
  clm_double[_clm_618_r + 0] = clm_double[_clm_620_r + 0];                      /* (setf _clm_618 _clm_620) */
  clm_int[_clm_607 + 0] = clm_int[_clm_618 + 0];
  clm_int[_clm_607 + 0 + 1] = clm_int[_clm_618 + 0 + 1];
  clm_double[_clm_607_r + 0] = clm_double[_clm_618_r + 0];                      /* (setf _clm_607 _clm_618) */
L_609:
                                                                                /* (progn */
                                                                                /* (if (or (zerop lasty) (zerop closest)) */
    if (clm_int[LASTY + 0]==1) _clm_634 = (clm_int[LASTY + 0 + 1] == 0); else _clm_634 = (clm_double[LASTY_r+0] == 0.0);
;                                                                               /* (zerop LASTY) */
  G632 = _clm_634;                                                              /* (setf G632 _clm_634) */
                                                                                /* (if g632 */
  if ((!G632)) goto L_636;
  clm_int[_clm_635 + 0] = 0;
  clm_int[_clm_635 + 0 + 1] = G632;                                             /* (setf _clm_635 G632) */
  goto L_637;
L_636:
    if (clm_int[CLOSEST + 0]==1) _clm_638 = (clm_int[CLOSEST + 0 + 1] == 0); else _clm_638 = (clm_double[CLOSEST_r+0] == 0.0);
;                                                                               /* (zerop CLOSEST) */
  clm_int[_clm_635 + 0] = 0;
  clm_int[_clm_635 + 0 + 1] = _clm_638;                                         /* (setf _clm_635 _clm_638) */
L_637:
  _clm_633 = ((clm_int[_clm_635] == 2) ? clm_double[_clm_635_r] : (double)(clm_int[_clm_635 + 1])); /* (setf _clm_633 _clm_635) */
  if ((!_clm_633)) goto L_629;
  clm_int[_clm_628 + 0] = 1;
  clm_int[_clm_628 + 0 + 1] = 0;                                                /* (setf _clm_628 0) */
  goto L_630;
L_629:
  _clm_640 = ((double)((clm_int[CLOSEST] == 2) ? clm_double[CLOSEST_r] : (double)(clm_int[CLOSEST + 1])) / (double)((((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])))));
                                                                                /* (/ CLOSEST lasty) */
  RATIO = _clm_640;                                                             /* (setf RATIO _clm_640) */
                                                                                /* (if (< ratio 1.0) */
  _clm_644 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_644)) goto L_642;
  _clm_646 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_646;                                                             /* (setf RATIO _clm_646) */
  clm_int[_clm_641 + 0] = 2;
  clm_double[_clm_641_r+0] = _clm_646;                                          /* (setf _clm_641 _clm_646) */
  goto L_643;
L_642:
  clm_int[_clm_641 + 0] = 2;
  clm_double[_clm_641_r+0] = RATIO;                                             /* (setf _clm_641 RATIO) */
L_643:
  clm_int[_clm_639 + 0] = clm_int[_clm_641 + 0];
  clm_int[_clm_639 + 0 + 1] = clm_int[_clm_641 + 0 + 1];
  clm_double[_clm_639_r + 0] = clm_double[_clm_641_r + 0];                      /* (setf _clm_639 _clm_641) */
  clm_int[_clm_628 + 0] = clm_int[_clm_639 + 0];
  clm_int[_clm_628 + 0 + 1] = clm_int[_clm_639 + 0 + 1];
  clm_double[_clm_628_r + 0] = clm_double[_clm_639_r + 0];                      /* (setf _clm_628 _clm_639) */
L_630:
  _clm_604 = (((clm_int[_clm_607] == 2) ? clm_double[_clm_607_r] : (double)(clm_int[_clm_607 + 1])) < ((clm_int[_clm_628] == 2) ? clm_double[_clm_628_r] : (double)(clm_int[_clm_628 + 1]))); /* (< _clm_607 _clm_628) */
  if ((!_clm_604)) goto L_602;
  clm_int[CLOSEST + 0] = clm_int[WINFREQ + 0];
  clm_int[CLOSEST + 0 + 1] = clm_int[WINFREQ + 0 + 1];
  clm_double[CLOSEST_r + 0] = clm_double[WINFREQ_r + 0];                        /* (setf CLOSEST WINFREQ) */
  goto L_603;
L_602:
L_603:
  goto L_597;
L_596:
  clm_int[CLOSEST + 0] = clm_int[WINFREQ + 0];
  clm_int[CLOSEST + 0 + 1] = clm_int[WINFREQ + 0 + 1];
  clm_double[CLOSEST_r + 0] = clm_double[WINFREQ_r + 0];                        /* (setf CLOSEST WINFREQ) */
L_597:
                                                                                /* (if (and (>= winfreq min-freq) (<= winfreq max-freq)
      (if contig
          (let ((lasty (aref freqs (1- j))))
            (<= (ac-get-ratio lasty winfreq) max-jump-ratio))
          t)) */
                                                                                /* (if (if (>= winfreq min-freq)
     (<= winfreq max-freq)) */
                                                                                /* (if (>= winfreq min-freq) */
  _clm_660 = (((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])) >= ((clm_int[MIN_FREQ] == 2) ? clm_double[MIN_FREQ_r] : (double)(clm_int[MIN_FREQ + 1]))); /* (>= WINFREQ MIN-FREQ) */
  if ((!_clm_660)) goto L_658;
  _clm_661 = (((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])) <= ((clm_int[MAX_FREQ] == 2) ? clm_double[MAX_FREQ_r] : (double)(clm_int[MAX_FREQ + 1]))); /* (<= WINFREQ MAX-FREQ) */
  _clm_657 = _clm_661;                                                          /* (setf _clm_657 _clm_661) */
  goto L_659;
L_658:
  _clm_657 = 0;                                                                 /* (setf _clm_657 NIL) */
L_659:
  if ((!_clm_657)) goto L_655;
                                                                                /* (if contig */
  if (((clm_int[CONTIG] == 0) && (clm_int[CONTIG + 1] == 0))) goto L_663;
  _clm_667 = J - 1.0;
  {int lci; lci = _clm_667;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_666 + 0] = 2;
  clm_double[_clm_666_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_666 + 0] = 1;
  clm_int[_clm_666 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_666 + 0] = clm_int[iblock];
      clm_int[_clm_666 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_666_r + 0] = clm_double[rblock];
  }}}

  clm_int[LASTY + 0] = clm_int[_clm_666 + 0];
  clm_int[LASTY + 0 + 1] = clm_int[_clm_666 + 0 + 1];
  clm_double[LASTY_r + 0] = clm_double[_clm_666_r + 0];                         /* (setf LASTY _clm_666) */
                                                                                /* (progn */
                                                                                /* (if (or (zerop lasty) (zerop winfreq)) */
    if (clm_int[LASTY + 0]==1) _clm_677 = (clm_int[LASTY + 0 + 1] == 0); else _clm_677 = (clm_double[LASTY_r+0] == 0.0);
;                                                                               /* (zerop LASTY) */
  G675 = _clm_677;                                                              /* (setf G675 _clm_677) */
                                                                                /* (if g675 */
  if ((!G675)) goto L_679;
  clm_int[_clm_678 + 0] = 0;
  clm_int[_clm_678 + 0 + 1] = G675;                                             /* (setf _clm_678 G675) */
  goto L_680;
L_679:
    if (clm_int[WINFREQ + 0]==1) _clm_681 = (clm_int[WINFREQ + 0 + 1] == 0); else _clm_681 = (clm_double[WINFREQ_r+0] == 0.0);
;                                                                               /* (zerop WINFREQ) */
  clm_int[_clm_678 + 0] = 0;
  clm_int[_clm_678 + 0 + 1] = _clm_681;                                         /* (setf _clm_678 _clm_681) */
L_680:
  _clm_676 = ((clm_int[_clm_678] == 2) ? clm_double[_clm_678_r] : (double)(clm_int[_clm_678 + 1])); /* (setf _clm_676 _clm_678) */
  if ((!_clm_676)) goto L_672;
  clm_int[_clm_671 + 0] = 1;
  clm_int[_clm_671 + 0 + 1] = 0;                                                /* (setf _clm_671 0) */
  goto L_673;
L_672:
  _clm_683 = ((double)((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])) / (double)((((clm_int[LASTY] == 2) ? clm_double[LASTY_r] : (double)(clm_int[LASTY + 1])))));
                                                                                /* (/ WINFREQ lasty) */
  RATIO = _clm_683;                                                             /* (setf RATIO _clm_683) */
                                                                                /* (if (< ratio 1.0) */
  _clm_687 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_687)) goto L_685;
  _clm_689 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_689;                                                             /* (setf RATIO _clm_689) */
  clm_int[_clm_684 + 0] = 2;
  clm_double[_clm_684_r+0] = _clm_689;                                          /* (setf _clm_684 _clm_689) */
  goto L_686;
L_685:
  clm_int[_clm_684 + 0] = 2;
  clm_double[_clm_684_r+0] = RATIO;                                             /* (setf _clm_684 RATIO) */
L_686:
  clm_int[_clm_682 + 0] = clm_int[_clm_684 + 0];
  clm_int[_clm_682 + 0 + 1] = clm_int[_clm_684 + 0 + 1];
  clm_double[_clm_682_r + 0] = clm_double[_clm_684_r + 0];                      /* (setf _clm_682 _clm_684) */
  clm_int[_clm_671 + 0] = clm_int[_clm_682 + 0];
  clm_int[_clm_671 + 0 + 1] = clm_int[_clm_682 + 0 + 1];
  clm_double[_clm_671_r + 0] = clm_double[_clm_682_r + 0];                      /* (setf _clm_671 _clm_682) */
L_673:
  _clm_668 = (((clm_int[_clm_671] == 2) ? clm_double[_clm_671_r] : (double)(clm_int[_clm_671 + 1])) <= ((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))); /* (<= _clm_671 MAX-JUMP-RATIO) */
  clm_int[_clm_665 + 0] = 0;
  clm_int[_clm_665 + 0 + 1] = _clm_668;                                         /* (setf _clm_665 _clm_668) */
  clm_int[_clm_662 + 0] = clm_int[_clm_665 + 0];
  clm_int[_clm_662 + 0 + 1] = clm_int[_clm_665 + 0 + 1];
  clm_double[_clm_662_r + 0] = clm_double[_clm_665_r + 0];                      /* (setf _clm_662 _clm_665) */
  goto L_664;
L_663:
  clm_int[_clm_662 + 0] = 0;
  clm_int[_clm_662 + 0 + 1] = 1;                                                /* (setf _clm_662 T) */
L_664:
  _clm_654 = ((clm_int[_clm_662] == 2) ? clm_double[_clm_662_r] : (double)(clm_int[_clm_662 + 1])); /* (setf _clm_654 _clm_662) */
  goto L_656;
L_655:
  _clm_654 = 0;                                                                 /* (setf _clm_654 NIL) */
L_656:
  if ((!_clm_654)) goto L_651;
                                                                                /* (progn */
  clm_int[FINISH + 0] = 0;
  clm_int[FINISH + 0 + 1] = 1;                                                  /* (setf FINISH T) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_57;
  goto L_652;
L_651:
L_652:
  _clm_696 = F + 1.0;
  F = _clm_696;                                                                 /* (setf F _clm_696) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_57;
END_LOOP_L_57:
                                                                                /* (block nil */
                                                                                /* (if (and (not finish) (= os max-samp-offset)) */
                                                                                /* (if (not finish) */
  _clm_706 = ((clm_int[FINISH] == 0) && (clm_int[FINISH + 1] == 0));            /* (null FINISH) */
  if ((!_clm_706)) goto L_704;
  _clm_707 = (OS == ((clm_int[MAX_SAMP_OFFSET] == 2) ? clm_double[MAX_SAMP_OFFSET_r] : (double)(clm_int[MAX_SAMP_OFFSET + 1]))); /* (== OS MAX-SAMP-OFFSET) */
  _clm_703 = _clm_707;                                                          /* (setf _clm_703 _clm_707) */
  goto L_705;
L_704:
  _clm_703 = 0;                                                                 /* (setf _clm_703 NIL) */
L_705:
  if ((!_clm_703)) goto L_700;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_711;
                                                                                /* (clm-print "Resorting to zero~%" ) */
  mus_error(0, "Resorting to zero\n");
  goto L_712;
L_711:
L_712:
  clm_int[WINFREQ + 0] = 1;
  clm_int[WINFREQ + 0 + 1] = 0;                                                 /* (setf WINFREQ 0) */
  goto L_701;
L_700:
L_701:
                                                                                /* (if finish */
  if (((clm_int[FINISH] == 0) && (clm_int[FINISH + 1] == 0))) goto L_717;
                                                                                /* (progn */
  clm_int[FINISH + 0] = 0;
  clm_int[FINISH + 0 + 1] = 0;                                                  /* (setf FINISH NIL) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_56;
  goto L_718;
L_717:
L_718:
  _clm_725 = OS + 1.0;
  OS = _clm_725;                                                                /* (setf OS _clm_725) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_56;
END_LOOP_L_56:
                                                                                /* (block nil */
                                                                                /* (if debug */
  if (((clm_int[DEBUG] == 0) && (clm_int[DEBUG + 1] == 0))) goto L_728;
                                                                                /* (clm-print "~F final frequency~%"  WINFREQ) */
  mus_error(0, "%f final frequency\n",
        (double)((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])));
  goto L_729;
L_728:
L_729:
  {int lci; lci = J;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[WINFREQ] == 2) ? clm_double[WINFREQ_r] : (double)(clm_int[WINFREQ + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[WINFREQ + 0];
      clm_int[iblock + 1] = clm_int[WINFREQ + 0 + 1];
      clm_double[rblock] = clm_double[WINFREQ_r+0];
  }}}

  I += ((clm_int[INCRSAMPS] == 2) ? clm_double[INCRSAMPS_r] : (double)(clm_int[INCRSAMPS + 1])); /* (incf I INCRSAMPS) */
  J += 1;                                                                       /* (incf J 1) */
                                                                                /* (if (>= i end) */
  _clm_738 = (I >= ((clm_int[END] == 2) ? clm_double[END_r] : (double)(clm_int[END + 1]))); /* (>= I END) */
  if ((!_clm_738)) goto L_736;
                                                                                /* (if post-process */
  if (((clm_int[POST_PROCESS] == 0) && (clm_int[POST_PROCESS + 1] == 0))) goto L_741;
  K = 1;                                                                        /* (setf K 1) */
  clm_int[MAX_CANDIDATES + 0] = clm_int[MAX_FILTER_CANDIDATES + 0];
  clm_int[MAX_CANDIDATES + 0 + 1] = clm_int[MAX_FILTER_CANDIDATES + 0 + 1];
  clm_double[MAX_CANDIDATES_r + 0] = clm_double[MAX_FILTER_CANDIDATES_r + 0];   /* (setf MAX-CANDIDATES MAX-FILTER-CANDIDATES) */
  clm_int[DEBUG + 2] = 0;
  clm_int[DEBUG + 2 + 1] = 0;                                                   /* (setf DEBUG NIL) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_747;
                                                                                /* (clm-print "~%Filter spikes: max-jump-ratio = ~F~%"  MAX-JUMP-RATIO) */
  mus_error(0, "\nFilter spikes: max-jump-ratio = %f\n",
        (double)((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1])));
  goto L_748;
L_747:
L_748:
                                                                                /* (tagbody */
NEXT_LOOP_L_66:
                                                                                /* (if (< k j) */
  _clm_758 = (K < J);                                                           /* (< K J) */
  if ((!_clm_758)) goto L_756;
  goto L_757;
L_756:
                                                                                /* (go end-loop */
  goto END_LOOP_L_66;
L_757:
  {int lci; lci = K;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_761 + 0] = 2;
  clm_double[_clm_761_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_761 + 0] = 1;
  clm_int[_clm_761 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_761 + 0] = clm_int[iblock];
      clm_int[_clm_761 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_761_r + 0] = clm_double[rblock];
  }}}

  clm_int[THISY + 0] = clm_int[_clm_761 + 0];
  clm_int[THISY + 0 + 1] = clm_int[_clm_761 + 0 + 1];
  clm_double[THISY_r + 0] = clm_double[_clm_761_r + 0];                         /* (setf THISY _clm_761) */
  _clm_763 = K - 1;
  {int lci; lci = _clm_763;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_762 + 0] = 2;
  clm_double[_clm_762_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_762 + 0] = 1;
  clm_int[_clm_762 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_762 + 0] = clm_int[iblock];
      clm_int[_clm_762 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_762_r + 0] = clm_double[rblock];
  }}}

  clm_int[PREVY + 0] = clm_int[_clm_762 + 0];
  clm_int[PREVY + 0 + 1] = clm_int[_clm_762 + 0 + 1];
  clm_double[PREVY_r + 0] = clm_double[_clm_762_r + 0];                         /* (setf PREVY _clm_762) */
                                                                                /* (progn */
                                                                                /* (if (or (zerop prevy) (zerop thisy)) */
    if (clm_int[PREVY + 0]==1) _clm_772 = (clm_int[PREVY + 0 + 1] == 0); else _clm_772 = (clm_double[PREVY_r+0] == 0.0);
;                                                                               /* (zerop PREVY) */
  G770 = _clm_772;                                                              /* (setf G770 _clm_772) */
                                                                                /* (if g770 */
  if ((!G770)) goto L_774;
  clm_int[_clm_773 + 0] = 0;
  clm_int[_clm_773 + 0 + 1] = G770;                                             /* (setf _clm_773 G770) */
  goto L_775;
L_774:
    if (clm_int[THISY + 0]==1) _clm_776 = (clm_int[THISY + 0 + 1] == 0); else _clm_776 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  clm_int[_clm_773 + 0] = 0;
  clm_int[_clm_773 + 0 + 1] = _clm_776;                                         /* (setf _clm_773 _clm_776) */
L_775:
  _clm_771 = ((clm_int[_clm_773] == 2) ? clm_double[_clm_773_r] : (double)(clm_int[_clm_773 + 1])); /* (setf _clm_771 _clm_773) */
  if ((!_clm_771)) goto L_767;
  clm_int[_clm_766 + 0] = 1;
  clm_int[_clm_766 + 0 + 1] = 0;                                                /* (setf _clm_766 0) */
  goto L_768;
L_767:
  _clm_778 = ((double)((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])) / (double)((((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1])))));
                                                                                /* (/ THISY prevy) */
  RATIO = _clm_778;                                                             /* (setf RATIO _clm_778) */
                                                                                /* (if (< ratio 1.0) */
  _clm_782 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_782)) goto L_780;
  _clm_784 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_784;                                                             /* (setf RATIO _clm_784) */
  clm_int[_clm_779 + 0] = 2;
  clm_double[_clm_779_r+0] = _clm_784;                                          /* (setf _clm_779 _clm_784) */
  goto L_781;
L_780:
  clm_int[_clm_779 + 0] = 2;
  clm_double[_clm_779_r+0] = RATIO;                                             /* (setf _clm_779 RATIO) */
L_781:
  clm_int[_clm_777 + 0] = clm_int[_clm_779 + 0];
  clm_int[_clm_777 + 0 + 1] = clm_int[_clm_779 + 0 + 1];
  clm_double[_clm_777_r + 0] = clm_double[_clm_779_r + 0];                      /* (setf _clm_777 _clm_779) */
  clm_int[_clm_766 + 0] = clm_int[_clm_777 + 0];
  clm_int[_clm_766 + 0 + 1] = clm_int[_clm_777 + 0 + 1];
  clm_double[_clm_766_r + 0] = clm_double[_clm_777_r + 0];                      /* (setf _clm_766 _clm_777) */
L_768:
  RATIO = ((clm_int[_clm_766] == 2) ? clm_double[_clm_766_r] : (double)(clm_int[_clm_766 + 1])); /* (setf RATIO _clm_766) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 2] == 0) && (clm_int[DEBUG + 2 + 1] == 0))) goto L_787;
                                                                                /* (clm-print "#~D thisy ~F prevy ~F ratio ~F~%"  K THISY PREVY RATIO) */
  mus_error(0, "#%" PRId64"  thisy %f prevy %f ratio %f\n",
        (mus_long_t)K,
        (double)((clm_int[THISY] == 2) ? clm_double[THISY_r] : (double)(clm_int[THISY + 1])),
        (double)((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1])),
        (double)RATIO);
  goto L_788;
L_787:
L_788:
                                                                                /* (if (or (and (zerop thisy) (zerop prevy))
     (and (not (zerop ratio)) (<= ratio max-jump-ratio))) */
                                                                                /* (if (zerop thisy) */
    if (clm_int[THISY + 0]==1) _clm_800 = (clm_int[THISY + 0 + 1] == 0); else _clm_800 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  if ((!_clm_800)) goto L_798;
    if (clm_int[PREVY + 0]==1) _clm_801 = (clm_int[PREVY + 0 + 1] == 0); else _clm_801 = (clm_double[PREVY_r+0] == 0.0);
;                                                                               /* (zerop PREVY) */
  clm_int[_clm_797 + 0] = 0;
  clm_int[_clm_797 + 0 + 1] = _clm_801;                                         /* (setf _clm_797 _clm_801) */
  goto L_799;
L_798:
  clm_int[_clm_797 + 0] = 0;
  clm_int[_clm_797 + 0 + 1] = 0;                                                /* (setf _clm_797 NIL) */
L_799:
  clm_int[G794 + 0] = clm_int[_clm_797 + 0];
  clm_int[G794 + 0 + 1] = clm_int[_clm_797 + 0 + 1];
  clm_double[G794_r + 0] = clm_double[_clm_797_r + 0];                          /* (setf G794 _clm_797) */
                                                                                /* (if g794 */
  if (((clm_int[G794] == 0) && (clm_int[G794 + 1] == 0))) goto L_803;
  clm_int[_clm_802 + 0] = clm_int[G794 + 0];
  clm_int[_clm_802 + 0 + 1] = clm_int[G794 + 0 + 1];
  clm_double[_clm_802_r + 0] = clm_double[G794_r + 0];                          /* (setf _clm_802 G794) */
  goto L_804;
L_803:
                                                                                /* (if (not (zerop ratio)) */
  _clm_810 = (RATIO == 0.0);                                                    /* (zerop RATIO) */
  _clm_809 = (!_clm_810);                                                       /* (null _clm_810) */
  if ((!_clm_809)) goto L_807;
  _clm_811 = (RATIO <= ((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))); /* (<= RATIO MAX-JUMP-RATIO) */
  clm_int[_clm_806 + 0] = 0;
  clm_int[_clm_806 + 0 + 1] = _clm_811;                                         /* (setf _clm_806 _clm_811) */
  goto L_808;
L_807:
  clm_int[_clm_806 + 0] = 0;
  clm_int[_clm_806 + 0 + 1] = 0;                                                /* (setf _clm_806 NIL) */
L_808:
  clm_int[_clm_802 + 0] = clm_int[_clm_806 + 0];
  clm_int[_clm_802 + 0 + 1] = clm_int[_clm_806 + 0 + 1];
  clm_double[_clm_802_r + 0] = clm_double[_clm_806_r + 0];                      /* (setf _clm_802 _clm_806) */
L_804:
  _clm_795 = ((clm_int[_clm_802] == 2) ? clm_double[_clm_802_r] : (double)(clm_int[_clm_802 + 1])); /* (setf _clm_795 _clm_802) */
  if ((!_clm_795)) goto L_791;
  K += 1;                                                                       /* (incf K 1) */
  goto L_792;
L_791:
                                                                                /* (if (= k (1- j)) */
  _clm_817 = J - 1.0;
  _clm_816 = (K == _clm_817);                                                   /* (== K _clm_817) */
  if ((!_clm_816)) goto L_814;
                                                                                /* (progn */
  {int lci; lci = K;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[PREVY + 0];
      clm_int[iblock + 1] = clm_int[PREVY + 0 + 1];
      clm_double[rblock] = clm_double[PREVY_r+0];
  }}}

                                                                                /* (go end-loop */
  goto END_LOOP_L_66;
  goto L_815;
L_814:
                                                                                /* (if (and (plusp thisy) (zerop prevy)) */
                                                                                /* (if (plusp thisy) */
    if (clm_int[THISY + 0]==1) _clm_829 = (clm_int[THISY + 0 + 1] > 0); else _clm_829 = (clm_double[THISY_r+0] > 0.0);
;                                                                               /* (plusp THISY) */
  if ((!_clm_829)) goto L_827;
    if (clm_int[PREVY + 0]==1) _clm_830 = (clm_int[PREVY + 0 + 1] == 0); else _clm_830 = (clm_double[PREVY_r+0] == 0.0);
;                                                                               /* (zerop PREVY) */
  _clm_826 = _clm_830;                                                          /* (setf _clm_826 _clm_830) */
  goto L_828;
L_827:
  _clm_826 = 0;                                                                 /* (setf _clm_826 NIL) */
L_828:
  if ((!_clm_826)) goto L_823;
  clm_int[MAX_CANDIDATES + 2] = clm_int[MAX_FILTER_CANDIDATES + 0];
  clm_int[MAX_CANDIDATES + 2 + 1] = clm_int[MAX_FILTER_CANDIDATES + 0 + 1];
  clm_double[MAX_CANDIDATES_r + 1] = clm_double[MAX_FILTER_CANDIDATES_r + 0];   /* (setf MAX-CANDIDATES MAX-FILTER-CANDIDATES) */
  clm_int[END + 2] = 2;
  clm_double[END_r+1] = J;                                                      /* (setf END J) */
  if (clm_int[END + 2] == 1)
    {clm_int[_clm_833 + 0] = 1;
  clm_int[_clm_833 + 0 + 1] = clm_int[END + 2 + 1] - 1;}
  else {clm_int[_clm_833 + 0] = 2;
  clm_double[_clm_833_r+0] = clm_double[END_r + 1] - 1.0;}
  clm_int[ENDMINUS + 0] = clm_int[_clm_833 + 0];
  clm_int[ENDMINUS + 0 + 1] = clm_int[_clm_833 + 0 + 1];
  clm_double[ENDMINUS_r + 0] = clm_double[_clm_833_r + 0];                      /* (setf ENDMINUS _clm_833) */
                                                                                /* (+ k max-candidates) */
  if ((1) && (clm_int[MAX_CANDIDATES + 2] == 1))
    {clm_int[_clm_835 + 0] = 1;
  clm_int[_clm_835 + 0 + 1] = ((K) + (clm_int[MAX_CANDIDATES + 2 + 1]));}
  else {clm_int[_clm_835 + 0] = 2;
  clm_double[_clm_835_r+0] = ((K) + (((clm_int[MAX_CANDIDATES + 2] == 2) ? clm_double[MAX_CANDIDATES_r + 1] : (double)(clm_int[MAX_CANDIDATES + 2 + 1]))));}
  if (clm_int[_clm_835 + 0] == 1)
    {clm_int[_clm_834 + 0] = 1;
  clm_int[_clm_834 + 0 + 1] = clm_int[_clm_835 + 0 + 1] - 1;}
  else {clm_int[_clm_834 + 0] = 2;
  clm_double[_clm_834_r+0] = clm_double[_clm_835_r + 0] - 1.0;}
  clm_int[CANDEND + 0] = clm_int[_clm_834 + 0];
  clm_int[CANDEND + 0 + 1] = clm_int[_clm_834 + 0 + 1];
  clm_double[CANDEND_r + 0] = clm_double[_clm_834_r + 0];                       /* (setf CANDEND _clm_834) */
  clm_int[DEBUG + 4] = 0;
  clm_int[DEBUG + 4 + 1] = 0;                                                   /* (setf DEBUG NIL) */
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_839;
                                                                                /* (clm-print "   Handling jump up from zero.~%" ) */
  mus_error(0, "   Handling jump up from zero.\n");
  goto L_840;
L_839:
L_840:
  M = K;                                                                        /* (setf M K) */
                                                                                /* (tagbody */
NEXT_LOOP_L_67:
                                                                                /* (progn */
                                                                                /* (if (= m endminus) */
  _clm_853 = (M == ((clm_int[ENDMINUS] == 2) ? clm_double[ENDMINUS_r] : (double)(clm_int[ENDMINUS + 1]))); /* (== M ENDMINUS) */
  if ((!_clm_853)) goto L_851;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_857;
                                                                                /* (clm-print "     End reached. Filling ~D to ~D with zero.~%"  K M) */
  mus_error(0, "     End reached. Filling %" PRId64"  to %" PRId64"  with zero.\n",
        (mus_long_t)K,
        (mus_long_t)M);
  goto L_858;
L_857:
L_858:
  N = K;                                                                        /* (setf N K) */
  LOOP_LIMIT_861 = M;                                                           /* (setf LOOP-LIMIT-861 M) */
                                                                                /* (tagbody */
NEXT_LOOP_L_68:
                                                                                /* (if (> n loop-limit-861) */
  _clm_871 = (N > LOOP_LIMIT_861);                                              /* (> N LOOP-LIMIT-861) */
  if ((!_clm_871)) goto L_869;
                                                                                /* (go end-loop */
  goto END_LOOP_L_68;
  goto L_870;
L_869:
L_870:
  {int lci; lci = N;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
    clm_int[iblock] = 1; clm_int[iblock + 1] = 0;
  }}}

  _clm_876 = N + 1;
  N = _clm_876;                                                                 /* (setf N _clm_876) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_68;
END_LOOP_L_68:
                                                                                /* (block nil */
  K = M;                                                                        /* (setf K M) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_67;
  goto L_852;
L_851:
L_852:
  {int lci; lci = M;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_882 + 0] = 2;
  clm_double[_clm_882_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_882 + 0] = 1;
  clm_int[_clm_882 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_882 + 0] = clm_int[iblock];
      clm_int[_clm_882 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_882_r + 0] = clm_double[rblock];
  }}}

  clm_int[THISY + 2] = clm_int[_clm_882 + 0];
  clm_int[THISY + 2 + 1] = clm_int[_clm_882 + 0 + 1];
  clm_double[THISY_r + 1] = clm_double[_clm_882_r + 0];                         /* (setf THISY _clm_882) */
  _clm_884 = M + 1;
  {int lci; lci = _clm_884;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_883 + 0] = 2;
  clm_double[_clm_883_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_883 + 0] = 1;
  clm_int[_clm_883 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_883 + 0] = clm_int[iblock];
      clm_int[_clm_883 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_883_r + 0] = clm_double[rblock];
  }}}

  clm_int[NEXTY + 0] = clm_int[_clm_883 + 0];
  clm_int[NEXTY + 0 + 1] = clm_int[_clm_883 + 0 + 1];
  clm_double[NEXTY_r + 0] = clm_double[_clm_883_r + 0];                         /* (setf NEXTY _clm_883) */
                                                                                /* (progn */
                                                                                /* (if (or (zerop nexty) (zerop thisy)) */
    if (clm_int[NEXTY + 0]==1) _clm_893 = (clm_int[NEXTY + 0 + 1] == 0); else _clm_893 = (clm_double[NEXTY_r+0] == 0.0);
;                                                                               /* (zerop NEXTY) */
  G891 = _clm_893;                                                              /* (setf G891 _clm_893) */
                                                                                /* (if g891 */
  if ((!G891)) goto L_895;
  clm_int[_clm_894 + 0] = 0;
  clm_int[_clm_894 + 0 + 1] = G891;                                             /* (setf _clm_894 G891) */
  goto L_896;
L_895:
    if (clm_int[THISY + 2]==1) _clm_897 = (clm_int[THISY + 2 + 1] == 0); else _clm_897 = (clm_double[THISY_r+1] == 0.0);
;                                                                               /* (zerop THISY) */
  clm_int[_clm_894 + 0] = 0;
  clm_int[_clm_894 + 0 + 1] = _clm_897;                                         /* (setf _clm_894 _clm_897) */
L_896:
  _clm_892 = ((clm_int[_clm_894] == 2) ? clm_double[_clm_894_r] : (double)(clm_int[_clm_894 + 1])); /* (setf _clm_892 _clm_894) */
  if ((!_clm_892)) goto L_888;
  clm_int[_clm_887 + 0] = 1;
  clm_int[_clm_887 + 0 + 1] = 0;                                                /* (setf _clm_887 0) */
  goto L_889;
L_888:
  _clm_899 = ((double)((clm_int[THISY + 2] == 2) ? clm_double[THISY_r + 1] : (double)(clm_int[THISY + 2 + 1])) / (double)((((clm_int[NEXTY] == 2) ? clm_double[NEXTY_r] : (double)(clm_int[NEXTY + 1])))));
                                                                                /* (/ THISY nexty) */
  RATIO = _clm_899;                                                             /* (setf RATIO _clm_899) */
                                                                                /* (if (< ratio 1.0) */
  _clm_903 = (RATIO < 1.0);                                                     /* (< RATIO 1.0) */
  if ((!_clm_903)) goto L_901;
  _clm_905 = (1.0 / (double)RATIO);                                             /* (/ RATIO) */
  RATIO = _clm_905;                                                             /* (setf RATIO _clm_905) */
  clm_int[_clm_900 + 0] = 2;
  clm_double[_clm_900_r+0] = _clm_905;                                          /* (setf _clm_900 _clm_905) */
  goto L_902;
L_901:
  clm_int[_clm_900 + 0] = 2;
  clm_double[_clm_900_r+0] = RATIO;                                             /* (setf _clm_900 RATIO) */
L_902:
  clm_int[_clm_898 + 0] = clm_int[_clm_900 + 0];
  clm_int[_clm_898 + 0 + 1] = clm_int[_clm_900 + 0 + 1];
  clm_double[_clm_898_r + 0] = clm_double[_clm_900_r + 0];                      /* (setf _clm_898 _clm_900) */
  clm_int[_clm_887 + 0] = clm_int[_clm_898 + 0];
  clm_int[_clm_887 + 0 + 1] = clm_int[_clm_898 + 0 + 1];
  clm_double[_clm_887_r + 0] = clm_double[_clm_898_r + 0];                      /* (setf _clm_887 _clm_898) */
L_889:
  clm_int[THISR + 0] = clm_int[_clm_887 + 0];
  clm_int[THISR + 0 + 1] = clm_int[_clm_887 + 0 + 1];
  clm_double[THISR_r + 0] = clm_double[_clm_887_r + 0];                         /* (setf THISR _clm_887) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_908;
                                                                                /* (clm-print "     Plateau candidate x=~D, thisy ~F nexty ~F ratio ~F.~%"  M THISY NEXTY THISR) */
  mus_error(0, "     Plateau candidate x=%" PRId64" , thisy %f nexty %f ratio %f.\n",
        (mus_long_t)M,
        (double)((clm_int[THISY + 2] == 2) ? clm_double[THISY_r + 1] : (double)(clm_int[THISY + 2 + 1])),
        (double)((clm_int[NEXTY] == 2) ? clm_double[NEXTY_r] : (double)(clm_int[NEXTY + 1])),
        (double)((clm_int[THISR] == 2) ? clm_double[THISR_r] : (double)(clm_int[THISR + 1])));
  goto L_909;
L_908:
L_909:
                                                                                /* (if (<= thisr max-jump-ratio) */
  _clm_915 = (((clm_int[THISR] == 2) ? clm_double[THISR_r] : (double)(clm_int[THISR + 1])) <= ((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))); /* (<= THISR MAX-JUMP-RATIO) */
  if ((!_clm_915)) goto L_913;
                                                                                /* (progn */
                                                                                /* (if (< k m) */
  _clm_920 = (K < M);                                                           /* (< K M) */
  if ((!_clm_920)) goto L_918;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_924;
  _clm_927 = M - 1;
                                                                                /* (clm-print "     Setting ~D to ~D to zero~%"  K _clm_927) */
  mus_error(0, "     Setting %" PRId64"  to %" PRId64"  to zero\n",
        (mus_long_t)K,
        (mus_long_t)_clm_927);
  goto L_925;
L_924:
L_925:
  N = K;                                                                        /* (setf N K) */
  _clm_933 = M - 1;
  LOOP_LIMIT_929 = _clm_933;                                                    /* (setf LOOP-LIMIT-929 _clm_933) */
                                                                                /* (tagbody */
NEXT_LOOP_L_69:
                                                                                /* (if (> n loop-limit-929) */
  _clm_940 = (N > LOOP_LIMIT_929);                                              /* (> N LOOP-LIMIT-929) */
  if ((!_clm_940)) goto L_938;
                                                                                /* (go end-loop */
  goto END_LOOP_L_69;
  goto L_939;
L_938:
L_939:
  {int lci; lci = N;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
    clm_int[iblock] = 1; clm_int[iblock + 1] = 0;
  }}}

  _clm_945 = N + 1;
  N = _clm_945;                                                                 /* (setf N _clm_945) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_69;
END_LOOP_L_69:
                                                                                /* (block nil */
  goto L_919;
L_918:
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_949;
                                                                                /* (clm-print "     Clean jump. No alterations needed~%" ) */
  mus_error(0, "     Clean jump. No alterations needed\n");
  goto L_950;
L_949:
L_950:
L_919:
  _clm_953 = M + 1;
  K = _clm_953;                                                                 /* (setf K _clm_953) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_67;
  goto L_914;
L_913:
L_914:
                                                                                /* (if (= m candend) */
  _clm_960 = (M == ((clm_int[CANDEND] == 2) ? clm_double[CANDEND_r] : (double)(clm_int[CANDEND + 1]))); /* (== M CANDEND) */
  if ((!_clm_960)) goto L_958;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_964;
                                                                                /* (clm-print "    Max candidates exceeded.~%" ) */
  mus_error(0, "    Max candidates exceeded.\n");
  goto L_965;
L_964:
L_965:
  K += 1;                                                                       /* (incf K 1) */
  goto L_959;
L_958:
L_959:
  _clm_970 = M + 1;
  M = _clm_970;                                                                 /* (setf M _clm_970) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_67;
END_LOOP_L_67:
                                                                                /* (block nil */
  goto L_824;
L_823:
  clm_int[MAX_CANDIDATES + 2] = clm_int[MAX_FILTER_CANDIDATES + 0];
  clm_int[MAX_CANDIDATES + 2 + 1] = clm_int[MAX_FILTER_CANDIDATES + 0 + 1];
  clm_double[MAX_CANDIDATES_r + 1] = clm_double[MAX_FILTER_CANDIDATES_r + 0];   /* (setf MAX-CANDIDATES MAX-FILTER-CANDIDATES) */
  clm_int[END + 2] = 2;
  clm_double[END_r+1] = J;                                                      /* (setf END J) */
  clm_int[DEBUG + 4] = 0;
  clm_int[DEBUG + 4 + 1] = 0;                                                   /* (setf DEBUG NIL) */
  _clm_979 = K + 1;
  J_1 = _clm_979;                                                               /* (setf J _clm_979) */
  LOOP_LIMIT_975 = J;                                                           /* (setf LOOP-LIMIT-975 J) */
  clm_int[C + 0] = 1;
  clm_int[C + 0 + 1] = 1;                                                       /* (setf C 1) */
                                                                                /* (tagbody */
                                                                                /* (if (> j loop-limit-975) */
  _clm_988 = (J_1 > LOOP_LIMIT_975);                                            /* (> J LOOP-LIMIT-975) */
  if ((!_clm_988)) goto L_986;
                                                                                /* (go end-loop */
  goto END_LOOP_L_70;
  goto L_987;
L_986:
L_987:
NEXT_LOOP_L_70:
  {int lci; lci = J_1;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_int[_clm_991 + 0] = 2;
  clm_double[_clm_991_r+0] = clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    case 37: clm_int[_clm_991 + 0] = 1;
  clm_int[_clm_991 + 0 + 1] = clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci]; break;
    default: {
      int iblock, rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci * 2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[_clm_991 + 0] = clm_int[iblock];
      clm_int[_clm_991 + 0 + 1] = clm_int[iblock+1];
      clm_double[_clm_991_r + 0] = clm_double[rblock];
  }}}

  clm_int[CAND + 0] = clm_int[_clm_991 + 0];
  clm_int[CAND + 0 + 1] = clm_int[_clm_991 + 0 + 1];
  clm_double[CAND_r + 0] = clm_double[_clm_991_r + 0];                          /* (setf CAND _clm_991) */
                                                                                /* (progn */
                                                                                /* (if (or (zerop prevy) (zerop cand)) */
    if (clm_int[PREVY + 0]==1) _clm_1000 = (clm_int[PREVY + 0 + 1] == 0); else _clm_1000 = (clm_double[PREVY_r+0] == 0.0);
;                                                                               /* (zerop PREVY) */
  G998 = _clm_1000;                                                             /* (setf G998 _clm_1000) */
                                                                                /* (if g998 */
  if ((!G998)) goto L_1002;
  clm_int[_clm_1001 + 0] = 0;
  clm_int[_clm_1001 + 0 + 1] = G998;                                            /* (setf _clm_1001 G998) */
  goto L_1003;
L_1002:
    if (clm_int[CAND + 0]==1) _clm_1004 = (clm_int[CAND + 0 + 1] == 0); else _clm_1004 = (clm_double[CAND_r+0] == 0.0);
;                                                                               /* (zerop CAND) */
  clm_int[_clm_1001 + 0] = 0;
  clm_int[_clm_1001 + 0 + 1] = _clm_1004;                                       /* (setf _clm_1001 _clm_1004) */
L_1003:
  _clm_999 = ((clm_int[_clm_1001] == 2) ? clm_double[_clm_1001_r] : (double)(clm_int[_clm_1001 + 1])); /* (setf _clm_999 _clm_1001) */
  if ((!_clm_999)) goto L_995;
  clm_int[_clm_994 + 0] = 1;
  clm_int[_clm_994 + 0 + 1] = 0;                                                /* (setf _clm_994 0) */
  goto L_996;
L_995:
  _clm_1006 = ((double)((clm_int[CAND] == 2) ? clm_double[CAND_r] : (double)(clm_int[CAND + 1])) / (double)((((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1])))));
                                                                                /* (/ CAND prevy) */
  RATIO = _clm_1006;                                                            /* (setf RATIO _clm_1006) */
                                                                                /* (if (< ratio 1.0) */
  _clm_1010 = (RATIO < 1.0);                                                    /* (< RATIO 1.0) */
  if ((!_clm_1010)) goto L_1008;
  _clm_1012 = (1.0 / (double)RATIO);                                            /* (/ RATIO) */
  RATIO = _clm_1012;                                                            /* (setf RATIO _clm_1012) */
  clm_int[_clm_1007 + 0] = 2;
  clm_double[_clm_1007_r+0] = _clm_1012;                                        /* (setf _clm_1007 _clm_1012) */
  goto L_1009;
L_1008:
  clm_int[_clm_1007 + 0] = 2;
  clm_double[_clm_1007_r+0] = RATIO;                                            /* (setf _clm_1007 RATIO) */
L_1009:
  clm_int[_clm_1005 + 0] = clm_int[_clm_1007 + 0];
  clm_int[_clm_1005 + 0 + 1] = clm_int[_clm_1007 + 0 + 1];
  clm_double[_clm_1005_r + 0] = clm_double[_clm_1007_r + 0];                    /* (setf _clm_1005 _clm_1007) */
  clm_int[_clm_994 + 0] = clm_int[_clm_1005 + 0];
  clm_int[_clm_994 + 0 + 1] = clm_int[_clm_1005 + 0 + 1];
  clm_double[_clm_994_r + 0] = clm_double[_clm_1005_r + 0];                     /* (setf _clm_994 _clm_1005) */
L_996:
  clm_int[CRATIO + 0] = clm_int[_clm_994 + 0];
  clm_int[CRATIO + 0 + 1] = clm_int[_clm_994 + 0 + 1];
  clm_double[CRATIO_r + 0] = clm_double[_clm_994_r + 0];                        /* (setf CRATIO _clm_994) */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1015;
  _clm_1018 = pow((double)(((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))), (double)(((clm_int[C] == 2) ? clm_double[C_r] : (double)(clm_int[C + 1])))); /* (expt MAX-JUMP-RATIO C) */
                                                                                /* (clm-print "   #~D, candidate #~D, ~F ratio ~F vs. max ~F~%"  J C CAND CRATIO _clm_1018) */
  mus_error(0, "   #%" PRId64" , candidate #%" PRId64" , %f ratio %f vs. max %f\n",
        (mus_long_t)J_1,
        (mus_long_t)((clm_int[C] == 2) ? clm_double[C_r] : (double)(clm_int[C + 1])),
        (double)((clm_int[CAND] == 2) ? clm_double[CAND_r] : (double)(clm_int[CAND + 1])),
        (double)((clm_int[CRATIO] == 2) ? clm_double[CRATIO_r] : (double)(clm_int[CRATIO + 1])),
        (double)_clm_1018);
  goto L_1016;
L_1015:
L_1016:
                                                                                /* (if (and (not (zerop cratio)) (<= cratio (expt max-jump-ratio c))) */
                                                                                /* (if (not (zerop cratio)) */
    if (clm_int[CRATIO + 0]==1) _clm_1027 = (clm_int[CRATIO + 0 + 1] == 0); else _clm_1027 = (clm_double[CRATIO_r+0] == 0.0);
;                                                                               /* (zerop CRATIO) */
  _clm_1026 = (!_clm_1027);                                                     /* (null _clm_1027) */
  if ((!_clm_1026)) goto L_1024;
  _clm_1029 = pow((double)(((clm_int[MAX_JUMP_RATIO] == 2) ? clm_double[MAX_JUMP_RATIO_r] : (double)(clm_int[MAX_JUMP_RATIO + 1]))), (double)(((clm_int[C] == 2) ? clm_double[C_r] : (double)(clm_int[C + 1])))); /* (expt MAX-JUMP-RATIO C) */
  _clm_1028 = (((clm_int[CRATIO] == 2) ? clm_double[CRATIO_r] : (double)(clm_int[CRATIO + 1])) <= _clm_1029); /* (<= CRATIO _clm_1029) */
  _clm_1023 = _clm_1028;                                                        /* (setf _clm_1023 _clm_1028) */
  goto L_1025;
L_1024:
  _clm_1023 = 0;                                                                /* (setf _clm_1023 NIL) */
L_1025:
  if ((!_clm_1023)) goto L_1020;
                                                                                /* (progn */
  M = K;                                                                        /* (setf M K) */
  LOOP_LIMIT_1032 = J_1;                                                        /* (setf LOOP-LIMIT-1032 J) */
                                                                                /* (tagbody */
NEXT_LOOP_L_71:
                                                                                /* (if (>= m loop-limit-1032) */
  _clm_1042 = (M >= LOOP_LIMIT_1032);                                           /* (>= M LOOP-LIMIT-1032) */
  if ((!_clm_1042)) goto L_1040;
                                                                                /* (go end-loop */
  goto END_LOOP_L_71;
  goto L_1041;
L_1040:
L_1041:
                                                                                /* (- j m) */
  _clm_1048 = ((J_1) - (M));
  _clm_1050 = K - 1;
                                                                                /* (- j _clm_1050) */
  _clm_1049 = ((J_1) - (_clm_1050));
  _clm_1047 = ((double)_clm_1048 / (double)((_clm_1049)));
                                                                                /* (/ _clm_1048 _clm_1049) */
  A = _clm_1047;                                                                /* (setf A _clm_1047) */
                                                                                /* (- 1 a) */
  _clm_1051 = ((1) - (A));
  B = _clm_1051;                                                                /* (setf B _clm_1051) */
                                                                                /* (* a prevy) */
  _clm_1053 = ((A) * (((clm_int[PREVY] == 2) ? clm_double[PREVY_r] : (double)(clm_int[PREVY + 1]))));
                                                                                /* (* b cand) */
  _clm_1054 = ((B) * (((clm_int[CAND] == 2) ? clm_double[CAND_r] : (double)(clm_int[CAND + 1]))));
                                                                                /* (+ _clm_1053 _clm_1054) */
  _clm_1052 = ((_clm_1053) + (_clm_1054));
  clm_int[_clm_1046 + 0] = 2;
  clm_double[_clm_1046_r+0] = _clm_1052;                                        /* (setf _clm_1046 _clm_1052) */
  clm_int[INTER + 0] = clm_int[_clm_1046 + 0];
  clm_int[INTER + 0 + 1] = clm_int[_clm_1046 + 0 + 1];
  clm_double[INTER_r + 0] = clm_double[_clm_1046_r + 0];                        /* (setf INTER _clm_1046) */
  {int lci; lci = M;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[INTER] == 2) ? clm_double[INTER_r] : (double)(clm_int[INTER + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[INTER] == 2) ? clm_double[INTER_r] : (double)(clm_int[INTER + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[INTER + 0];
      clm_int[iblock + 1] = clm_int[INTER + 0 + 1];
      clm_double[rblock] = clm_double[INTER_r+0];
  }}}

                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1058;
                                                                                /* (clm-print "     #~D point interpolated to ~F~%"  M INTER) */
  mus_error(0, "     #%" PRId64"  point interpolated to %f\n",
        (mus_long_t)M,
        (double)((clm_int[INTER] == 2) ? clm_double[INTER_r] : (double)(clm_int[INTER + 1])));
  goto L_1059;
L_1058:
L_1059:
  _clm_1063 = M + 1;
  M = _clm_1063;                                                                /* (setf M _clm_1063) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_71;
END_LOOP_L_71:
                                                                                /* (block nil */
  _clm_1066 = J_1 + 1.0;
  K = _clm_1066;                                                                /* (setf K _clm_1066) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_70;
  goto L_1021;
L_1020:
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1072;
                                                                                /* (clm-print "     candidate rejected~%" ) */
  mus_error(0, "     candidate rejected\n");
  goto L_1073;
L_1072:
L_1073:
                                                                                /* (if (= c max-candidates) */
  _clm_1079 = (((clm_int[C] == 2) ? clm_double[C_r] : (double)(clm_int[C + 1])) == ((clm_int[MAX_CANDIDATES + 2] == 2) ? clm_double[MAX_CANDIDATES_r + 1] : (double)(clm_int[MAX_CANDIDATES + 2 + 1]))); /* (== C MAX-CANDIDATES) */
  if ((!_clm_1079)) goto L_1077;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1083;
                                                                                /* (clm-print "   Max candidates exceeded.~%" ) */
  mus_error(0, "   Max candidates exceeded.\n");
  goto L_1084;
L_1083:
L_1084:
                                                                                /* (if (and (zerop cand) (plusp prevy)) */
                                                                                /* (if (zerop cand) */
    if (clm_int[CAND + 0]==1) _clm_1093 = (clm_int[CAND + 0 + 1] == 0); else _clm_1093 = (clm_double[CAND_r+0] == 0.0);
;                                                                               /* (zerop CAND) */
  if ((!_clm_1093)) goto L_1091;
    if (clm_int[PREVY + 0]==1) _clm_1094 = (clm_int[PREVY + 0 + 1] > 0); else _clm_1094 = (clm_double[PREVY_r+0] > 0.0);
;                                                                               /* (plusp PREVY) */
  _clm_1090 = _clm_1094;                                                        /* (setf _clm_1090 _clm_1094) */
  goto L_1092;
L_1091:
  _clm_1090 = 0;                                                                /* (setf _clm_1090 NIL) */
L_1092:
  if ((!_clm_1090)) goto L_1087;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1098;
                                                                                /* (clm-print "   Jump down to zero. Setting ~D to ~D to 0.~%"  K J) */
  mus_error(0, "   Jump down to zero. Setting %" PRId64"  to %" PRId64"  to 0.\n",
        (mus_long_t)K,
        (mus_long_t)J_1);
  goto L_1099;
L_1098:
L_1099:
  M = K;                                                                        /* (setf M K) */
  LOOP_LIMIT_1102 = J_1;                                                        /* (setf LOOP-LIMIT-1102 J) */
                                                                                /* (tagbody */
NEXT_LOOP_L_72:
                                                                                /* (if (> m loop-limit-1102) */
  _clm_1112 = (M > LOOP_LIMIT_1102);                                            /* (> M LOOP-LIMIT-1102) */
  if ((!_clm_1112)) goto L_1110;
                                                                                /* (go end-loop */
  goto END_LOOP_L_72;
  goto L_1111;
L_1110:
L_1111:
  {int lci; lci = M;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = 0; break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
    clm_int[iblock] = 1; clm_int[iblock + 1] = 0;
  }}}

  _clm_1117 = M + 1;
  M = _clm_1117;                                                                /* (setf M _clm_1117) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_72;
END_LOOP_L_72:
                                                                                /* (block nil */
  _clm_1120 = J_1 + 1.0;
  K = _clm_1120;                                                                /* (setf K _clm_1120) */
  goto L_1088;
L_1087:
  K += 1;                                                                       /* (incf K 1) */
L_1088:
                                                                                /* (go end-loop */
  goto END_LOOP_L_70;
  goto L_1078;
L_1077:
L_1078:
                                                                                /* (if (= j end) */
  _clm_1128 = (J_1 == ((clm_int[END + 2] == 2) ? clm_double[END_r + 1] : (double)(clm_int[END + 2 + 1]))); /* (== J END) */
  if ((!_clm_1128)) goto L_1126;
                                                                                /* (progn */
                                                                                /* (if debug */
  if (((clm_int[DEBUG + 4] == 0) && (clm_int[DEBUG + 4 + 1] == 0))) goto L_1132;
  _clm_1135 = J_1 - 1.0;
                                                                                /* (if (zerop thisy) */
    if (clm_int[THISY + 0]==1) _clm_1139 = (clm_int[THISY + 0 + 1] == 0); else _clm_1139 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  if ((!_clm_1139)) goto L_1137;
  clm_int[_clm_1136 + 0] = 1;
  clm_int[_clm_1136 + 0 + 1] = 0;                                               /* (setf _clm_1136 0) */
  goto L_1138;
L_1137:
  clm_int[_clm_1136 + 0] = clm_int[PREVY + 0];
  clm_int[_clm_1136 + 0 + 1] = clm_int[PREVY + 0 + 1];
  clm_double[_clm_1136_r + 0] = clm_double[PREVY_r + 0];                        /* (setf _clm_1136 PREVY) */
L_1138:
                                                                                /* (clm-print "End of array, setting ~D to ~D to ~F ~%"  K _clm_1135 _clm_1136) */
  mus_error(0, "End of array, setting %" PRId64"  to %" PRId64"  to %f \n",
        (mus_long_t)K,
        (mus_long_t)_clm_1135,
        (double)((clm_int[_clm_1136] == 2) ? clm_double[_clm_1136_r] : (double)(clm_int[_clm_1136 + 1])));
  goto L_1133;
L_1132:
L_1133:
                                                                                /* (progn */
  M = K;                                                                        /* (setf M K) */
  _clm_1146 = J_1 - 1.0;
  LOOP_LIMIT_1142 = _clm_1146;                                                  /* (setf LOOP-LIMIT-1142 _clm_1146) */
                                                                                /* (tagbody */
NEXT_LOOP_L_73:
                                                                                /* (if (> m loop-limit-1142) */
  _clm_1153 = (M > LOOP_LIMIT_1142);                                            /* (> M LOOP-LIMIT-1142) */
  if ((!_clm_1153)) goto L_1151;
                                                                                /* (go end-loop */
  goto END_LOOP_L_73;
  goto L_1152;
L_1151:
L_1152:
                                                                                /* (if (zerop thisy) */
    if (clm_int[THISY + 0]==1) _clm_1159 = (clm_int[THISY + 0 + 1] == 0); else _clm_1159 = (clm_double[THISY_r+0] == 0.0);
;                                                                               /* (zerop THISY) */
  if ((!_clm_1159)) goto L_1157;
  clm_int[_clm_1156 + 0] = 1;
  clm_int[_clm_1156 + 0 + 1] = 0;                                               /* (setf _clm_1156 0) */
  goto L_1158;
L_1157:
  clm_int[_clm_1156 + 0] = clm_int[PREVY + 0];
  clm_int[_clm_1156 + 0 + 1] = clm_int[PREVY + 0 + 1];
  clm_double[_clm_1156_r + 0] = clm_double[PREVY_r + 0];                        /* (setf _clm_1156 PREVY) */
L_1158:
  {int lci; lci = M;
  switch (CLM_ARR_TYPE(clm_int[FREQS + 0 + 1]))
    {
    case 36: clm_double[CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[_clm_1156] == 2) ? clm_double[_clm_1156_r] : (double)(clm_int[_clm_1156 + 1])); break;
    case 37: clm_int[CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + lci] = ((clm_int[_clm_1156] == 2) ? clm_double[_clm_1156_r] : (double)(clm_int[_clm_1156 + 1])); break;
    default: {
      int iblock,rblock;
      iblock = CLM_ARR_IBLOCK(clm_int[FREQS + 0 + 1]) + (lci*2); rblock = CLM_ARR_RBLOCK(clm_int[FREQS + 0 + 1]) + lci;
      clm_int[iblock] = clm_int[_clm_1156 + 0];
      clm_int[iblock + 1] = clm_int[_clm_1156 + 0 + 1];
      clm_double[rblock] = clm_double[_clm_1156_r+0];
  }}}

  _clm_1162 = M + 1;
  M = _clm_1162;                                                                /* (setf M _clm_1162) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_73;
END_LOOP_L_73:
                                                                                /* (block nil */
  K = J_1;                                                                      /* (setf K J) */
                                                                                /* (go end-loop */
  goto END_LOOP_L_70;
  goto L_1127;
L_1126:
L_1127:
L_1021:
  _clm_1169 = J_1 + 1.0;
  J_1 = _clm_1169;                                                              /* (setf J _clm_1169) */
                                                                                /* (if (> j loop-limit-975) */
  _clm_1174 = (J_1 > LOOP_LIMIT_975);                                           /* (> J LOOP-LIMIT-975) */
  if ((!_clm_1174)) goto L_1172;
                                                                                /* (go end-loop */
  goto END_LOOP_L_70;
  goto L_1173;
L_1172:
L_1173:
  if (clm_int[C + 0] == 1)
    {clm_int[_clm_1178 + 0] = 1;
  clm_int[_clm_1178 + 0 + 1] = clm_int[C + 0 + 1] + 1;}
  else {clm_int[_clm_1178 + 0] = 2;
  clm_double[_clm_1178_r+0] = clm_double[C_r + 0] + 1.0;}
  clm_int[C + 0] = clm_int[_clm_1178 + 0];
  clm_int[C + 0 + 1] = clm_int[_clm_1178 + 0 + 1];
  clm_double[C_r + 0] = clm_double[_clm_1178_r + 0];                            /* (setf C _clm_1178) */
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_70;
END_LOOP_L_70:
                                                                                /* (block nil */
L_824:
L_815:
L_792:
                                                                                /* (go next-loop */
  goto NEXT_LOOP_L_66;
END_LOOP_L_66:
                                                                                /* (block nil */
  goto L_742;
L_741:
L_742:
  goto L_737;
L_736:
L_737:
  I++;                                                                          /* increment pass counter and loop */
goto SAMPLE_LOOP_BEGIN;

RUN_ALL_DONE:
  clm_signal(SIGINT,old_SIGINT);
  clm_double[176] = LOOP_LIMIT_45;
  clm_double[177] = OS;
  clm_double[178] = LOOP_LIMIT_166;
  clm_double[179] = F;
  clm_double[180] = LOOP_LIMIT_188;
  clm_double[182] = LOOP_LIMIT_211;
  clm_double[183] = LOOP_LIMIT_256;
  clm_double[184] = LOOP_LIMIT_395;
  clm_double[185] = LOOP_LIMIT_446;
  clm_int[359] = MAXPEAKINDEX;
  clm_double[186] = LOOP_LIMIT_505;
  clm_double[187] = LOOP_LIMIT_549;
  clm_int[365] = LOOP_LIMIT_861;
  clm_double[188] = LOOP_LIMIT_975;
  clm_double[189] = LOOP_LIMIT_1032;
  clm_double[190] = LOOP_LIMIT_1102;
  if (all_gens) clm_free_genbag(all_gens);

  return(1);
}

