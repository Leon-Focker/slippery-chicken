<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>slippery chicken documentation - instruments and
      instrument-palettes</title> 
    <!-- change the following two file paths to be ../ if in a subdirectory -->
    <link href="../sc-stylesheet.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../head-foot.js"></script>
    <script language="javascript" type="text/javascript"
            src="../show-hide.js"></script>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  </head>
  
  <body onload="showHide(window.location.hash.substring(1)+'-div')" >
    <div id="content">
      <!-- files in the doc directory will call header with argument "./" but
           those in subdirectories will need "../" -->
      <script type="text/javascript">header("../");</script>
      <noscript>Your browser does not support JavaScript!</noscript>
      <!-- **************************************************************** -->
      
      <h2>Instruments and instrument-palettes</h2>

      <h3 id="files"><a href="#files" id="files-div-show"
                        onclick="showHide('files-div');return false;">+</a>
        Associated example files</h3>
      <div id="files-div" class="more">
        <ul>
          <li><a href="../examples/instruments-examples.lsp">instruments-examples.lsp</a></li> 
        </ul>
        <p class="close"><a href="#" id="files-div-hide" class="hideLink"
                            onclick="showHide('files-div');return
                            false;">close</a></p> 
        <br />
      </div>

      <p>This page addresses topics related to <em>instruments</em>
        and <em>instrument-palettes</em>. A separate page is available for
        information specific to <a href="./ensemble.html">players and the
        ensemble</a>. </p>

      <h3 id="instruments"><a href="#instruments" id="instruments-div-show"
                          onclick="showHide('instruments-div');return
                          false;">+</a> 
        Instrument objects</h3>
      <div id="instruments-div" class="more">
        <p>The <em>slippery chicken</em> <code>instrument</code> class
          currently has 25 slots, 21 of which are used to define the
          instrument's attributes and 4 of which can be used to retrieve
          information about data that <em>slippery chicken</em> has generated
          for that instrument.</p> 

        <p>The slots that define the instrument's attributes include parameters
          such as the highest and lowest pitches of the instrument's range, its
          transposition etc., as well as parameters necessary for output, such
          as the instrument's full and abbreviated staff names for the score,
          the clef it uses, or the MIDI program it is to use for playback
          etc.</p>

        <p>Parameters can also be specified that affect <em>slippery
          chicken's</em> automatic selection of pitches for the instrument,
          including whether the instrument can play microtones, whether it can
          play chords, which chord function is to be used when selecting
          pitches for those chords, and pitch subsets that limit the automatic
          pitch selection for that instrument etc.</p> 

        <p>The various slots of an <code>instrument</code> object can be set
          using keyword arguments. This allows <code>instrument</code> objects
          to be created using any combination of any number of the slot names
          available. A simple definition of an <code>instrument</code> object
          within an <code>instrument-palette</code> may look like this:</p>

        <pre class="source">
(soprano
 (:staff-name "soprano" :staff-short-name "s"
  :lowest-written c4 :highest-written c6
  :starting-clef treble
  :midi-program 54))</pre>

        <p class="nb">NB: This is the syntax for defining
          an <code>instrument</code> object within
          an <code>instrument-palette</code> using
          the <code>make-instrument-palette</code> function. This syntax is
          minimally different to that of the <code>make-instrument</code>
          function; however, the keyword arguments are all the same. See the
          source code documentation
          on <a href="../robodoc/instrument_lsp.html#instrument2fmake2dinstrument"><code>make-instrument</code></a> 
          for a description of the keyword arguments and how to create
          an <code>instrument</code> object directly using that function. This
          page will make reference to both approaches.</p>

        <p>Details on all of these parameters and the slot names required for
          modifying their values can be found in the source code documentation
          for
          the <a href="../robodoc/instrument_lsp.html#instrument2fmake2dinstrument"><code>make-instrument</code></a>
          function. </p>
        
        <p class="close"><a href="#" id="instruments-div-hide" class="hideLink"
              onclick="showHide('instruments-div');return false;">close</a></p> 
      </div>

      <h3 id="palettes"><a href="#palettes" id="palettes-div-show"
                           onclick="showHide('palettes-div');return
                                    false;">+</a>
        Instrument palettes</h3>
      <div id="palettes-div" class="more">
        <p>In order for <em>slippery chicken</em> to access instrument
          definitions, they must be stored in an
          <code>instrument-palette</code>. <em>slippery chicken</em> loads with
          a predefined <code>instrument-palette</code>, which consists of
          most standard instruments, assigned to the <a
                           href="../robodoc/instruments_lsp.html#instruments2f2bslippery2dchicken2dstandard2dinstrument2dpalette2b">global
                           variable</a>   
          <code>+slippery-chicken-standard-instrument-palette+</code>. This
          variable and the <code>instrument</code> objects assigned to it
          should generally be suitable for most compositions.</p> 

        <p>However, a number of options are available should the palette not
          contain a specific instrument, or should the user desire to change
          the attributes of a given instrument (such as making the range
          smaller for younger players etc.). Although this could be done by
          editing the <code>instruments.lsp</code> file directly, this is
          strongly discouraged, as updating <em>slippery chicken</em> in the
          future might overwrite carefully executed edits.</p>

        <p class="nb">NB:
          The <code>+slippery-chicken-standard-instrument-palette+</code> also
          serves as the default <code>instrument-palette</code> for all
          new <code>slippery-chicken</code> objects should none be otherwise
          specified. This allows the user to omit
          the <code>:instrument-palette</code> keyword argument from
          the <code>make-slippery-chicken</code> function if
          the <code>instrument</code> object definitions from the standard
          palette are sufficient. Since explicitly stating the standard
          palette is a functionally legitimate approach, the examples in this
          manual will sometimes include the specification of
          the <code>instrument-palette</code> and sometimes omit it.</p>

        <p class="close"><a href="#" id="palettes-div-hide" class="hideLink"
              onclick="showHide('palettes-div');return false;">close</a></p>
      </div>
      
      <h3 id="separate"><a href="#separate" id="separate-div-show"
                           onclick="showHide('separate-div');return
                                    false;">+</a> 
        Creating a new instrument-palette</h3>
      <div id="separate-div" class="more">
        <p>One option for defining new instruments or new versions of existing
          instruments is to use the
          <a href="../robodoc/instrument-palette_lsp.html#instrument2dpalette2fmake2dinstrument2dpalette"><code>make-instrument-palette</code></a>
          function.  This function takes a list of instrument descriptions
          based on the keyword arguments of
          the <a href="../robodoc/instrument_lsp.html#instrument2fmake2dinstrument"><code>make-instrument</code></a>
          function.</p>
      
        <p>An example of its usage might look like this:</p>
        
        <pre class="source">
(defparameter +plucked-strings-aux-instrument-palette+
  (make-instrument-palette
   'plucked-strings-aux-instrument-palette
   '((mandolin
      (:staff-name "mandolin" :staff-short-name "md"
       :lowest-written g3 :highest-written a6 :starting-clef treble
       :chords t :microtones nil :missing-notes nil 
       :midi-program 26))
     (tenor-banjo
      (:staff-name "tenor banjo" :staff-short-name "t-bj"
       :lowest-written c3 :highest-written a4 :starting-clef treble
       :transposition-semitones -12
       :chords t :microtones nil :missing-notes nil 
       :midi-program 106)))))</pre>

        <!-- MDE Wed Feb 11 15:19:42 2015 -->
        <p>Instrument palettes can also be created on-the-fly as part of the
        call to <code>make-slippery-chicken</code>. The following is taken from
        our <a href="../examples/template.lsp">template</a> file:
        
<pre class="source">    
(make-slippery-chicken  
 '+your-title-here+ 
 :title "Your Title Here" 
 :composer "Your Name Here"
 ;; +slippery-chicken-standard-instrument-palette+ is the default instrument
 ;; palette. Only specify this slot if you need something special. See
 ;; instruments.lsp in the src directory (or http://tinyurl.com/pjbgnae) for
 ;; details of all pre-defined instruments. But here's an example of the kind
 ;; of thing to do if you do want to define your own.
 :instrument-palette
 '((piccolo (:transposition-semitones 12 :lowest-written d4
             :highest-written c6))
   ;; a more complete definition, by way of example
   (flute (:staff-name "flute" :staff-short-name "fl" 
           :lowest-written c4 :highest-written d7 
           :missing-notes (cqs4 dqf4) 
           :largest-fast-leap 19
           :starting-clef treble
           :chords nil 
           :microtones t 
           :midi-program 74))
   (b-flat-clarinet (:transposition-semitones -2 :lowest-written e3
                 :highest-written c6))  
   (violin (:lowest-written g3 :highest-written c7 :chords t)))
 :ensemble '(((flt ((flute piccolo) :midi-channel 1))
              (clr (b-flat-clarinet :midi-channel 2))
              (vln-one (violin :midi-channel 3))))
...
</pre>

        <p>A typical entry for a given instrument will first need a symbol as
          its name, such as the symbols <code>mandolin</code> and
          <code>tenor-banjo</code> in the example above. This will be used
          later to assign an <code>instrument</code> to a <code>player</code>
          in an <code>ensemble</code>. The <code>instrument</code> definition
          will then generally consist of at least the
          parameters <code>staff-name</code>,
          <code>staff-short-name</code>, <code>lowest-written</code>,
          <code>highest-written</code>, <code>transposition-semitones</code>
          (if applicable), <code>starting-clef</code>, <code>chords</code>,
          and <code>midi-program</code>. See the source code documentation for
          the <a href="../robodoc/instrument_lsp.html#instrument2fmake2dinstrument"><code>make-instrument</code></a>
          function for more details on these and other possible keywords.</p>

        <p>The symbols chosen as the names of <code>instrument</code> objects
          in a given <code>instrument-palette</code> are then the symbols used
          in the <code>ensemble</code> block of the <em>slippery chicken</em>
          object created for a given piece. </p>

        <h4>Saving the code for an instrument-palette to be loaded later</h4>
        <p>The user can also save the code for creating
          separate <code>instrument-palette</code> objects in a separate file
          so that these palettes can be loaded for use with future pieces. In
          such cases, the entire <code>defparameter</code> expression should be
          saved in a file with the <code>.lsp</code> suffix and loaded again
          later using Lisp's <code>load</code> function prior to evaluating
          the <code>make-slippery-chicken</code> function for which the palette
          is to be used, e.g.:</p>

        <pre class="source">
(load "/path/to/my-inst-palette.lsp") </pre>

        <p class="close"><a href="#" id="separate-div-hide" class="hideLink"
              onclick="showHide('separate-div');return false;">close</a></p>
      </div>
           
<!--
      <h3 id="combining"><a href="#combining" id="combining-div-show"
                            onclick="showHide('combining-div');return
                            false;">+</a>
        Combining existing instrument-palettes</h3>
      <div id="combining-div" class="more">
        <p>Two or more existing <code>instrument-palettes</code> can also be
          combined for the scope of one piece by using the <code>combine</code>
          method. For example, the user can create a
          new <code>instrument-palette</code> for a given piece by combining
          the
          predefined <code>+slippery-chicken-standard-instrument-palette+</code>
          with the above defined +plucked-strings-aux-instrument-palette+, as
          such: </p>

        <pre class="source">
(combine +slippery-chicken-standard-instrument-palette+
         +plucked-strings-aux-instrument-palette+)</pre>

        <p>This can be passed directly to the <code>instrument-palette</code>
          keyword argument within the <code>make-slippery-chicken</code>
          function, as such:</p>
      
        <pre class="source">
:instrument-palette (combine +plucked-strings-aux-instrument-palette+
                             +slippery-chicken-standard-instrument-palette+)</pre>

        <p>&hellip;or it can be assigned to a (perhaps global) variable and the
          variable can be passed to the keyword argument, as such:</p>

        <pre class="source">
(defparameter +combined-instrument-palette+     
              (combine +slippery-chicken-standard-instrument-palette+
                       +plucked-strings-aux-instrument-palette+))

:instrument-palette +combined-instrument-palette+</pre>

        <p>The <code>combine</code> method can also be used to append a group
          of new <code>instrument</code> definitions directly to an
          existing <code>instrument-palette</code>, as such:</p>

        <pre class="source">
(combine
  +slippery-chicken-standard-instrument-palette+
  (make-instrument-palette
   'auxiliary-instruments
    '((toy-piano
       (:staff-name "toy piano" ...</pre>

        <p>As with the creation of a separate <code>instrument-palette</code>,
          this can be saved to a separate file and loaded for future
          pieces.</p>


        <p class="close"><a href="#" id="combining-div-hide" class="hideLink"
              onclick="showHide('combining-div');return false;">close</a></p>
      </div>

-->
      
      <h3 id="adding"><a href="#adding" id="adding-div-show"
                         onclick="showHide('adding-div');return false;">+</a>
        Adding instruments to existing instrument-palettes</h3>
      <div id="adding-div" class="more">
        <p>If the user would like to add a single <code>instrument</code>
          object to an existing <code>instrument-palette</code>, this can be
          done using the <code>add</code> method:</p>

        <pre class="source">
(add
  (make-instrument 'mandolin
                   :staff-name "mandolin" :staff-short-name "md"
                   :lowest-written 'g3 :highest-written 'a6 
                   :starting-clef 'treble 
                   :chords t :microtones nil :missing-notes nil 
                   :midi-program 26)
 +slippery-chicken-standard-instrument-palette+)</pre>


        <p class="close"><a href="#" id="adding-div-hide" class="hideLink"
              onclick="showHide('adding-div');return false;">close</a></p>
      </div>

      <h3 id="changing"><a href="#changing" id="changing-div-show"
                           onclick="showHide('changing-div');return
                           false;">+</a> Changing instrument attributes
                           temporarily</h3>
      <div id="changing-div" class="more">
        <p>Any of the values stored in the various <em>slots</em> of
          an <code>instrument</code> object contained within a
          given <code>instrument-palette</code> can also be changed temporarily
          (until the same slot is changed again later, the current Lisp session
          is ended, or the given <code>instrument-palette</code> is reloaded)
          using the <code>set-slot</code> method in combination with the slot
          names (which are the same as the keyword arguments of the
          <a href="../robodoc/instrument_lsp.html#instrument2fmake2dinstrument"><code>make-instrument</code></a>
          function) for the values that are to be changed.</p>

        <p>For example, to change the value of the <code>lowest-written</code>
          slot for the <code>instrument</code> object with the
          ID <code>flute</code> in
          the <code>+slippery-chicken-standard-instrument-palette+</code>
          to <code>B3</code>, the following can be done:</p>

        <pre class="source">
(set-slot 'lowest-written 
          'b3 
          'flute
          +slippery-chicken-standard-instrument-palette+)</pre> 

        <p>This might also be combined with a <code>loop</code> to change many
          slot values at once, as is done for
          the <code>largest-fast-leap</code> slot of a number of the
          instruments in
          the <a href="./intraphrasal-loops.html#inst-atts">second
          tutorial</a>.</p>

        
        <p class="close"><a href="#" id="changing-div-hide" class="hideLink"
              onclick="showHide('changing-div');return
                       false;">close</a></p>  
      </div>

      <!-- **************************************************************** --> 
      <!-- This spacer <br> is necessary as a buffer between the content and
         the footer. It cannot be added as padding to #push, since #push has to
         be the same size as #footer in order for the dynamic placement to work
         properly --> 
      <br /><br />
      <div id="push"></div>
    </div>
    <script type="text/javascript">footer();</script>
    <noscript>Your browser does not support JavaScript!</noscript>
  </body>
</html>
